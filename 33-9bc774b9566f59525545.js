!function(){"use strict";function e(){}function t(e,t,n,o,r){for(var i=0,s=t.length,u=0,l=0;i<s;i++){var a=t[i];if(a.removed){if(a.value=e.join(o.slice(l,l+a.count)),l+=a.count,i&&t[i-1].added){var c=t[i-1];t[i-1]=t[i],t[i]=c}}else{if(!a.added&&r){var d=n.slice(u,u+a.count);d=d.map((function(e,t){var n=o[l+t];return n.length>e.length?n:e})),a.value=e.join(d)}else a.value=e.join(n.slice(u,u+a.count));u+=a.count,a.added||(l+=a.count)}}var f=t[s-1];return s>1&&"string"==typeof f.value&&(f.added||f.removed)&&e.equals("",f.value)&&(t[s-2].value+=f.value,t.pop()),t}function n(e){return{newPos:e.newPos,components:e.components.slice(0)}}e.prototype={diff:function(e,o){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.callback;"function"==typeof r&&(i=r,r={}),this.options=r;var s=this;function u(e){return i?(setTimeout((function(){i(void 0,e)}),0),!0):e}e=this.castInput(e),o=this.castInput(o),e=this.removeEmpty(this.tokenize(e));var l=(o=this.removeEmpty(this.tokenize(o))).length,a=e.length,c=1,d=l+a,f=[{newPos:-1,components:[]}],h=this.extractCommon(f[0],o,e,0);if(f[0].newPos+1>=l&&h+1>=a)return u([{value:this.join(o),count:o.length}]);function p(){for(var r=-1*c;r<=c;r+=2){var i=void 0,d=f[r-1],h=f[r+1],p=(h?h.newPos:0)-r;d&&(f[r-1]=void 0);var g=d&&d.newPos+1<l,v=h&&0<=p&&p<a;if(g||v){if(!g||v&&d.newPos<h.newPos?(i=n(h),s.pushComponent(i.components,void 0,!0)):((i=d).newPos++,s.pushComponent(i.components,!0,void 0)),p=s.extractCommon(i,o,e,r),i.newPos+1>=l&&p+1>=a)return u(t(s,i.components,o,e,s.useLongestToken));f[r]=i}else f[r]=void 0}c++}if(i)!function e(){setTimeout((function(){if(c>d)return i();p()||e()}),0)}();else for(;c<=d;){var g=p();if(g)return g}},pushComponent:function(e,t,n){var o=e[e.length-1];o&&o.added===t&&o.removed===n?e[e.length-1]={count:o.count+1,added:t,removed:n}:e.push({count:1,added:t,removed:n})},extractCommon:function(e,t,n,o){for(var r=t.length,i=n.length,s=e.newPos,u=s-o,l=0;s+1<r&&u+1<i&&this.equals(t[s+1],n[u+1]);)s++,u++,l++;return l&&e.components.push({count:l}),e.newPos=s,u},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};new e;var o=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,r=/\S/,i=new e;i.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!r.test(e)&&!r.test(t)},i.tokenize=function(e){for(var t=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&o.test(t[n])&&o.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t};var s=new e;s.tokenize=function(e){var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var o=0;o<n.length;o++){var r=n[o];o%2&&!this.options.newlineIsToken?t[t.length-1]+=r:(this.options.ignoreWhitespace&&(r=r.trim()),t.push(r))}return t};var u=new e;u.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};var l=new e;function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}l.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var c=Object.prototype.toString,d=new e;function f(e,t,n,o,r){var i,s;for(t=t||[],n=n||[],o&&(e=o(r,e)),i=0;i<t.length;i+=1)if(t[i]===e)return n[i];if("[object Array]"===c.call(e)){for(t.push(e),s=new Array(e.length),n.push(s),i=0;i<e.length;i+=1)s[i]=f(e[i],t,n,o,r);return t.pop(),n.pop(),s}if(e&&e.toJSON&&(e=e.toJSON()),"object"===a(e)&&null!==e){t.push(e),s={},n.push(s);var u,l=[];for(u in e)e.hasOwnProperty(u)&&l.push(u);for(l.sort(),i=0;i<l.length;i+=1)s[u=l[i]]=f(e[u],t,n,o,u);t.pop(),n.pop()}else s=e;return s}d.useLongestToken=!0,d.tokenize=s.tokenize,d.castInput=function(e){var t=this.options,n=t.undefinedReplacement,o=t.stringifyReplacer,r=void 0===o?function(e,t){return void 0===t?n:t}:o;return"string"==typeof e?e:JSON.stringify(f(e,null,null,r),r,"  ")},d.equals=function(t,n){return e.prototype.equals.call(d,t.replace(/,([\r\n])/g,"$1"),n.replace(/,([\r\n])/g,"$1"))};var h=new e;function p(e,t,n){if(t.length>e.length)return!1;const o=e.length-t.length;if(n){for(let r=0;r<t.length;r++)if(!n(e[o+r],t[r]))return!1}else for(let r=0;r<t.length;r++)if(e[o+r]!==t[r])return!1;return!0}function g(e,t){if(!e)throw new Error(t)}h.tokenize=function(e){return e.slice()},h.join=h.removeEmpty=function(e){return e};new Set,new Map;function v(e){const t=[{type:"Unchanged",left:[],right:[]}];for(const n of e){const e=t[t.length-1];"Unchanged"===e.type&&"Unchanged"===n.type?(e.left.push(...n.left),e.right.push(...n.right)):"Changed"===e.type&&"Changed"===n.type?(e.removed.push(...n.removed),e.added.push(...n.added)):t.push(n)}return t}function m(e,t,n){return function(e,t,n){const o=v(e);for(let r=0;r<o.length;r+=2){const e=o[r],i=o[r+1];if(i)if(0===i.added.length){if(p(i.removed,e.left,t)){const t=i.removed.length-e.left.length,n=i.removed.slice(0,t),s=i.removed.slice(t);o[r]={type:"Changed",removed:[...e.left,...n],added:[]},o[r+1]={type:"Unchanged",left:s,right:e.right}}}else if(0===i.removed.length&&p(i.added,e.right,n)){const t=i.added.length-e.right.length,n=i.added.slice(0,t),s=i.added.slice(t);o[r]={type:"Changed",removed:[],added:[...e.right,...n]},o[r+1]={type:"Unchanged",left:e.left,right:s}}}return o}(function*(e,t,n){const o=(r=e,i=t,s={comparator:n},h.diff(r,i,s));var r,i,s;let u=0,l=0;for(const a of o)if(a.added)l+=a.value.length,yield{type:"Changed",removed:[],added:a.value};else if(a.removed)u+=a.value.length,yield{type:"Changed",removed:a.value,added:[]};else{const n=a.value.length,o=e.slice(u,u+n),r=t.slice(l,l+n);u+=n,l+=n,yield{type:"Unchanged",left:o,right:r}}}(e,t,n),n,n)}function*y(e){const t=v(e);for(let o=0;o<t.length;o+=2){var n;const e=t[o],r=null!==(n=t[o+1])&&void 0!==n?n:{type:"Changed",added:[],removed:[]};yield[e,r]}}function w(e,t){const{diff:n}=function(e,t){let n=m(b(e),b(t),j.equals);const o=new Map;n=function*(e,t){for(const n of v(e))"Unchanged"!==n.type||t(n)?yield n:yield{type:"Changed",removed:n.left,added:n.right}}(n,(e=>{const t=q(e.left.join(""))||q(e.right.join(""));if(t){g(e.left.length===e.right.length);for(let t=0;t<e.left.length;t++){const n=e.left[t],r=e.right[t];g(!o.has(n)),o.set(n,r),g(!o.has(r)),o.set(r,n)}}return!t}));const r=[...y(n)].map(P.fromEditPair),i=new Map,s=(e,t)=>{var n,r;const s=o.get(e);g(void 0!==s),i.set(e,Math.max(null!==(n=i.get(e))&&void 0!==n?n:0,t)),i.set(s,Math.max(null!==(r=i.get(s))&&void 0!==r?r:0,t))};return r.flatMap((e=>[e.left.removed,e.right.added])).flatMap((e=>function(e,t){const n=[];let o=0;for(const r of e){const e=t(r,o++),i=n[n.length-1];i&&i.category===e?i.items.push(r):n.push({category:e,items:[r]})}return n}(e,(e=>o.has(e))))).filter((e=>e.category)).forEach((e=>{const t=e.items.join("").length;e.items.forEach((e=>s(e,t)))})),{diff:r,scores:i}}(e,t),o=n.reduce(((e,t)=>e+t.left.equal.length),0);return{diff:n.map((e=>new P({equal:C(e.left.equal),removed:C(e.left.removed)},{equal:C(e.right.equal),added:C(e.right.added)}))),sharedWords:o}}function C(e){return e.join("")}class P{constructor(e,t){this.left=e,this.right=t}static fromEditPair([e,t]){return new P({equal:e.left,removed:t.removed},{equal:e.right,added:t.added})}}function q(e){return/^[\s\p{P}]*$/u.test(e)||e.length<=12}class j{constructor(e,t){this.raw=e,this.compareValue=t}toString(){return this.raw}static equals(e,t){return e.compareValue===t.compareValue}}const k=/[\s()[\]{},;:]/.source,S=k.replace(/^\[/,"[^"),E=`${k}*(${S}+)${k}*`;function b(e){const t=[];let n=0;const o=RegExp(E,"uy");for(let r;r=o.exec(e);){const e=r[0],o=r[1].replace(/[^\p{Alpha}\p{digit}]+/gu,"").toUpperCase()||r[1];t.push(new j(e,o)),n=r.index+e.length}if(n<e.length){const o=e.slice(n);t.push(new j(o,o))}return t}self.onmessage=({data:{left:e,right:t,id:n}})=>{const o=w(e,t);self.postMessage({diff:o,id:n})}}();
//# sourceMappingURL=33-9bc774b9566f59525545.js.map