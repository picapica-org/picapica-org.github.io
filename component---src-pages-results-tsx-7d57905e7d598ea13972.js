"use strict";(self.webpackChunkpicapica_web_client=self.webpackChunkpicapica_web_client||[]).push([[446],{5818:function(e,t,n){n.d(t,{r:function(){return s}});var r=n(7294);function s({className:e,grow:t,left:n,right:s}){return r.createElement("div",{className:"CenterAlignTwo"+(e?" "+e:"")},r.createElement("div",{className:"left"+("left"===t?" grow":"")},n),r.createElement("div",{className:"right"+("right"===t?" grow":"")},s))}},2503:function(e,t,n){n.d(t,{hu:function(){return m},__:function(){return a},Rk:function(){return u}});var r=n(7294),s=n(1513),l=n(8587);const c={en:{core_fulltext_languagenameenglish:{title:"CORE - The world's largest collection of open-access research papers"}},de:{core_fulltext_languagenameenglish:{title:"CORE - The world's largest collection of open-access research papers"}}},o={};var i=n(3097);function a(e){return r.createElement("span",{className:"Label"},e.icon&&r.createElement(i.fd,{kind:e.icon}),r.createElement("span",{className:"text"},e.text))}function u(){const e=(0,l.ql)(f);return r.createElement(a,{icon:"upload",text:e.submittedFiles})}function m(e){const{urn:t,collection:n}=function(e){if("collection"in e)return{urn:s.f.parse(e.collection.urn),collection:e.collection};{var t;let n,r;if("string"==typeof e.collectionUrn){const t=s.f.tryParse(e.collectionUrn);if(!t||"collection"!==t.type)return{urn:void 0,collection:void 0};n=t,r=e.collectionUrn}else n=e.collectionUrn,r=s.f.stringify(n);return{urn:n,collection:null===(t=e.collections)||void 0===t?void 0:t.find((e=>e.urn===r))}}}(e),{title:i}=function(e){const t=(0,l.ql)(c),n="string"==typeof e?s.f.tryParse(e):e;if(n&&"collection"===n.type){const e=t[n.collectionId];if(e)return e}return o}(t);return i?r.createElement(a,{text:i}):null!=n&&n.properties?r.createElement(a,{text:`${n.properties.name} - ${n.properties.description}`}):r.createElement(d,null)}function d(){const e=(0,l.ql)(f);return r.createElement(a,{text:e.unknown})}const f={en:{submittedFiles:"Your submitted files",unknown:"Unknown"},de:{submittedFiles:"Ihre eingereichten Dateien",unknown:"Unbekannt"}}},9356:function(e,t,n){n.d(t,{T:function(){return l}});var r=n(7294),s=n(3097);function l({id:e}){return r.createElement("span",{className:"LoaderAnimation",id:e}," ",r.createElement(s.JO,{kind:"loader-5-line"}),r.createElement(s.JO,{kind:"loader-5-line"}))}},8557:function(e,t,n){n.d(t,{Vl:function(){return N},O6:function(){return k},sJ:function(){return p},u$:function(){return h}});var r=n(1082),s=n(7294),l=n(603),c=n(1513);function o(e){const t={items:[],collections:new Map,invalid:[]};function n(e,n,r){const s=c.f.stringify({type:"collection",collectionId:n.collectionId});let l=t.collections.get(s);void 0===l&&(l=[],t.collections.set(s,l)),l.push({item:e,document:n,result:r})}for(const i of e){var r,s,l,o;const e=c.f.tryParse(null!==(r=null===(s=i.resources)||void 0===s?void 0:s.urnA)&&void 0!==r?r:""),a=c.f.tryParse(null!==(l=null===(o=i.resources)||void 0===o?void 0:o.urnB)&&void 0!==l?l:"");e&&a?"item"===e.type&&"item"===a.type?t.items.push({a:e,b:a,result:i}):"item"===e.type&&"document"===a.type?n(e,a,i):"document"===e.type&&"item"===a.type?n(a,e,i):t.invalid.push(i):t.invalid.push(i)}return t}var i=n(478),a=n(8587);function u({kind:e,children:t}){return s.createElement("span",{className:`Badge ${e}`},t)}var m=n(4761),d=n(5818),f=n(3097),E=n(2503),v=n(9356);function p({backTo:e,title:t,children:n}){const l=(0,a.ql)(T);return s.createElement("div",{className:"OverviewContainer"},s.createElement("div",{className:"head"},e&&s.createElement(r.rU,{className:m.E.BUTTON,to:e,title:l.back},s.createElement(f.fd,{kind:"back"})),s.createElement("div",null,t)),s.createElement("div",{className:"content"},n))}function h({session:e,collections:t,backTo:n,itemTo:c,collectionTo:i}){const f=(0,a.ql)(T),h=o(e.resultsList);h.invalid.length&&(console.error("Not displaying the following results:"),console.error(h.invalid));const k=s.createElement(d.r,{grow:"left",left:s.createElement(E.__,{icon:"results",text:f.analysisResults}),right:s.createElement(u,{kind:"Dark"},f.results)}),N=e.status===l.Session.ComputeStatus.STATUS_RUNNING;return s.createElement("div",{className:"ResultsOverview"},s.createElement(p,{backTo:n,title:k},s.createElement("div",null,s.createElement(r.rU,{className:m.E.BUTTON,to:c},s.createElement(d.r,{grow:"left",left:s.createElement(E.Rk,null),right:s.createElement(u,{kind:"Light"},N&&s.createElement(v.T,null),h.items.length)}))),[...h.collections].map((([n,l])=>s.createElement("div",{key:n},s.createElement(g,{sessionUrn:e.urn,results:l}),s.createElement(r.rU,{className:m.E.BUTTON,to:i(n)},s.createElement(d.r,{grow:"left",left:s.createElement(E.hu,{collectionUrn:n,collections:t}),right:s.createElement(u,{kind:"Light"},l.length)})))))))}function g({sessionUrn:e,results:t}){return(0,i.x)(e,t.map((e=>c.f.stringify(e.document)))),s.createElement(s.Fragment,null)}function k({session:e,backTo:t,resultTo:n}){const c=(0,a.ql)(T),{items:i}=o(e.resultsList),f=s.createElement(d.r,{grow:"left",left:s.createElement(E.Rk,null),right:s.createElement(u,{kind:"Dark"},c.matches)}),h=new Map(e.itemsList.map((e=>{var t;return[e.urn,null===(t=e.meta)||void 0===t?void 0:t.name]})));return s.createElement("div",{className:"ItemResultsOverview"},s.createElement(p,{backTo:t,title:f},i.map((({result:t})=>{var o,i,a,f,E,p;const g=null!==(o=h.get(null!==(i=null===(a=t.resources)||void 0===a?void 0:a.urnA)&&void 0!==i?i:""))&&void 0!==o?o:c.unknownItem,k=null!==(f=h.get(null!==(E=null===(p=t.resources)||void 0===p?void 0:p.urnB)&&void 0!==E?E:""))&&void 0!==f?f:c.unknownItem;return s.createElement("div",{key:t.urn},s.createElement(r.rU,{className:m.E.BUTTON,to:n(t)},s.createElement(d.r,{grow:"left",left:s.createElement("span",{className:"item-vs"},s.createElement("span",{className:"left"},g),s.createElement("span",{className:"vs"},"vs."),s.createElement("span",{className:"right"},k)),right:e.status===l.Session.ComputeStatus.STATUS_COMPLETED?s.createElement(u,{kind:"Light"},t.seedsList.length):s.createElement(v.T,null)})))})),0===i.length&&s.createElement("div",{className:"no-results"},c.noResults)))}function N({session:e,collectionUrn:t,collections:n,backTo:i,resultTo:f}){var h;const g=(0,a.ql)(T),k=null!==(h=o(e.resultsList).collections.get(t))&&void 0!==h?h:[],N=s.createElement(d.r,{grow:"left",left:s.createElement(E.hu,{collectionUrn:t,collections:n}),right:s.createElement(u,{kind:"Dark"},g.matches)}),w=new Map(e.itemsList.map((e=>{var t;return[e.urn,null===(t=e.meta)||void 0===t?void 0:t.name]})));return s.createElement("div",{className:"CollectionResultsOverview"},s.createElement(p,{backTo:i,title:N},k.map((({item:t,document:n,result:o})=>{var i;const a=null!==(i=w.get(c.f.stringify(t)))&&void 0!==i?i:g.unknownItem,E=s.createElement(y,{sessionUrn:e.urn,urn:c.f.stringify(n)});return s.createElement("div",{key:o.urn},s.createElement(r.rU,{className:m.E.BUTTON,to:f(o)},s.createElement(d.r,{grow:"left",left:s.createElement("span",{className:"item-vs"},s.createElement("span",{className:"left"},a),s.createElement("span",{className:"vs"},"vs."),s.createElement("span",{className:"right"},E)),right:e.status===l.Session.ComputeStatus.STATUS_COMPLETED?s.createElement(u,{kind:"Light"},o.seedsList.length):s.createElement(v.T,null)})))})),0===k.length&&s.createElement("div",{className:"no-results"},g.noResults)))}function y({sessionUrn:e,urn:t}){const n=(0,i.e)(e,t);var r;return null!=n&&n.properties?s.createElement(s.Fragment,null,null===(r=n.properties)||void 0===r?void 0:r.title):s.createElement(v.T,null)}const T={en:{back:"Back",analysisResults:"Analysis results",results:"Results",matches:"Matches",noResults:"No results",unknownItem:"<unknown>"},de:{back:"Zurück",analysisResults:"Analyse­ergebnisse",results:"Ergebnisse",matches:"Treffer",noResults:"Keine Ergebnisse",unknownItem:"<unbekannt>"}}},1878:function(e,t,n){n.d(t,{n0:function(){return v},Px:function(){return m}});var r=n(1082),s=n(7294),l=n(4831),c=n(8587),o=n(5461),i=n(4761);function a({heading:e,children:t}){return s.createElement("div",{className:"Group"},s.createElement("div",{className:"group-heading"},e),s.createElement("div",{className:"group-container"},t))}var u=n(3097);function m(e,t){switch(e){case"submit":return(0,l.me)({urn:t});case"analysis":return(0,l.sF)({urn:t});case"checkout":return"/checkout/";case"results":return(0,l.bq)({urn:t});default:(0,o.vE)(e)}}const d=["submit","analysis","checkout","results"],f={submit:"upload",analysis:"analyse",checkout:"checkout",results:"results"};function E({current:e,sessionUrn:t,disableOthers:n}){const l=(0,c.ql)(p);return s.createElement("span",{className:`StepSelector ${i.E.BUTTON_GROUP}`},d.filter((e=>"checkout"!==e)).map((c=>{const o=l[c];return n&&c!==e?s.createElement("span",{key:c,className:`${i.E.BUTTON} ${i.E.DISABLED}`,title:o},s.createElement(u.fd,{kind:f[c]}),s.createElement("span",{className:"text"},o)):s.createElement(r.rU,{key:c,to:m(c,t),className:`${i.E.BUTTON}${c===e?" "+i.E.ACTIVE:""}`,title:o},s.createElement(u.fd,{kind:f[c]}),s.createElement("span",{className:"text"},o))})))}function v({current:e,sessionUrn:t,disableOthers:n,children:r}){return s.createElement("div",{className:"StepSelectorGroup"},s.createElement(a,{heading:s.createElement("div",{className:"heading-wrapper"},s.createElement(E,{current:e,sessionUrn:t,disableOthers:n}))},r))}const p={en:{submit:"Upload",analysis:"Analysis",checkout:"Checkout",results:"Results"},de:{submit:"Hochladen",analysis:"Analyse",checkout:"Kasse",results:"Ergebnisse"}}},495:function(e,t,n){function r(e){return JSON.parse(JSON.stringify(e))}function s(){const e=Date.now();return{seconds:Math.floor(e/1e3),nanos:e%1e3*1e7}}function l(e,t){return e.seconds===t.seconds?e.nanos-t.nanos:e.seconds-t.seconds}function c(e){return[...e].sort(((e,t)=>{const n=e.createdAt,r=t.createdAt;return n||r?n?r?l(n,r)||e.urn.localeCompare(t.urn):1:-1:0}))}n.d(t,{R3:function(){return r},VN:function(){return s},a$:function(){return c},pv:function(){return l}})},478:function(e,t,n){n.d(t,{e:function(){return i},x:function(){return a}});var r=n(3467),s=n(603),l=n(693);async function c(e){const[,t,n]=e.queryKey,r=new s.GetDocumentRequest;r.setSessionUrn(t),r.setDocumentUrn(n);return(await(0,l.M)().getDocument(r,null)).toObject().document}function o(e,t){return{queryKey:["collection-document",e,t],queryFn:c,refetchInterval:!1,refetchOnMount:!1,refetchOnReconnect:!1,refetchOnWindowFocus:!1}}function i(e,t){const n=o(e,t);return(0,r.useQuery)(n.queryKey,n).data}function a(e,t){(0,r.useQueries)(t.map((t=>o(e,t))))}},7339:function(e,t,n){n.d(t,{b:function(){return c}});var r=n(3467),s=n(603),l=n(693);function c(e){return[(0,r.useQuery)(["collections",e],{refetchInterval:!1,refetchOnMount:!1,refetchOnReconnect:!1,refetchOnWindowFocus:!1,queryFn:async()=>{const t=new s.GetCollectionsRequest;t.setSessionUrn(e);return(await(0,l.M)().getCollections(t,null)).toObject().collectionsList}}).data]}},6143:function(e,t,n){n.r(t),n.d(t,{Head:function(){return w},default:function(){return U}});var r=n(7294),s=n(6208),l=n(8557),c=n(7601),o=n(8252),i=n(1878),a=n(603),u=n(4831),m=n(9067),d=n(6120),f=n(7339);const E=new(n(7842).B)("last-compute-cache");function v(e){var t;return JSON.stringify(null!==(t=e.config)&&void 0!==t?t:{})}var p=n(693),h=n(495),g=n(5461);const k=e=>{if(e.status===a.Session.ComputeStatus.STATUS_UNDEFINED){const t=(0,h.R3)(e);return t.status=a.Session.ComputeStatus.STATUS_RUNNING,t}return e};function N(e,t){const[n,s]=(0,r.useState)(0);(0,m.bd)((async r=>{if("Ready"!==e.type)return;const{session:l}=e;if(l.status===a.Session.ComputeStatus.STATUS_RUNNING)return;if(void 0!==function(e){const t=v(e),n=E.get(e.urn);if((null==n?void 0:n.id)===t)return new Date(n.when)}(l))return;n>0&&(await(0,g.gw)(3e3),r.checkCanceled());const c=new a.ComputeResultsRequest;c.setSessionUrn(l.urn),console.log("Compute results");const o=(0,p.M)().computeResults(c,null).then((()=>{!function(e){E.set(e.urn,{id:v(e),when:Date.now()})}(l),s(0)}),(e=>{throw s((e=>e+1)),e}));t(o,k)}),g.ZT,g.ZT,[e,t,n,s])}var y=n(8587),T=n(5820);const w=()=>r.createElement(r.Fragment,null,r.createElement("title",null,"Picapica"),r.createElement(o.s,null));var U=(0,m.kj)((function(){const e=(0,y.ql)(C),[t,n]=(0,T.zU)();N(t,n);const[o]=(0,f.b)((0,T.PK)(t)),m=function(){const e=(0,d.Ee)().get("view");return e?function(e){if(e){if("items"===e)return S;const t=/^collection:([^]+)$/.exec(e);if(t)return{type:"collection",collectionUrn:t[1]}}return b}(e):b}(),E=e=>(0,u.K8)({urn:e.urn,view:O(m)});return r.createElement(s.T,{className:"Results",header:"small"},r.createElement(c.sM,{state:t,onReady:({session:t})=>{const n=(0,g.Gi)(m,{overview:()=>r.createElement(l.u$,{session:t,collections:o,backTo:(0,i.Px)("analysis",t.urn),itemTo:R(t.urn,S),collectionTo:e=>R(t.urn,{type:"collection",collectionUrn:e})}),items:()=>r.createElement(l.O6,{session:t,backTo:R(t.urn,b),resultTo:E}),collection:({collectionUrn:e})=>r.createElement(l.Vl,{collectionUrn:e,session:t,collections:o,backTo:R(t.urn,b),resultTo:E})}),s=t.status===a.Session.ComputeStatus.STATUS_RUNNING;return r.createElement(r.Fragment,null,n,r.createElement("p",{className:"loading",style:s?{}:{opacity:0,userSelect:"none"}},e.running))}}))}));const b={type:"overview"},S={type:"items"};function O(e){return"items"===e.type?"items":"collection"===e.type?`collection:${e.collectionUrn}`:void 0}function R(e,t){return(0,u.bq)({urn:e,view:O(t)})}const C={en:{running:"Your submitted files are currently being processed. This might take a few seconds."},de:{running:"Ihre Eingabe wird bearbeited. Dies kann ein paar Sekunden dauern."}}}}]);
//# sourceMappingURL=component---src-pages-results-tsx-7d57905e7d598ea13972.js.map