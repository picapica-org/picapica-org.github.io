"use strict";(self.webpackChunkpicapica_web_client=self.webpackChunkpicapica_web_client||[]).push([[446],{5818:function(e,t,n){n.d(t,{r:function(){return r}});var s=n(7294);function r({className:e,grow:t,left:n,right:r}){return s.createElement("div",{className:"CenterAlignTwo"+(e?" "+e:"")},s.createElement("div",{className:"left"+("left"===t?" grow":"")},n),s.createElement("div",{className:"right"+("right"===t?" grow":"")},r))}},2503:function(e,t,n){n.d(t,{hu:function(){return m},__:function(){return a},Rk:function(){return u}});var s=n(7294),r=n(1513),c=n(6627);const o={en:{core_fulltext_languagenameenglish:{title:"CORE - The world's largest collection of open-access research papers"}},de:{core_fulltext_languagenameenglish:{title:"CORE - The world's largest collection of open-access research papers"}}},l={};var i=n(3097);function a(e){return s.createElement("span",{className:"Label"},e.icon&&s.createElement(i.fd,{kind:e.icon}),s.createElement("span",{className:"text"},e.text))}function u(){const e=(0,c.q)(d);return s.createElement(a,{icon:"upload",text:e.submittedFiles})}function m(e){const{urn:t,collection:n}=function(e){if("collection"in e)return{urn:r.f.parse(e.collection.urn),collection:e.collection};{var t;let n,s;if("string"==typeof e.collectionUrn){const t=r.f.tryParse(e.collectionUrn);if(!t||"collection"!==t.type)return{urn:void 0,collection:void 0};n=t,s=e.collectionUrn}else n=e.collectionUrn,s=r.f.stringify(n);return{urn:n,collection:null===(t=e.collections)||void 0===t?void 0:t.find((e=>e.urn===s))}}}(e),{title:i}=function(e){const t=(0,c.q)(o),n="string"==typeof e?r.f.tryParse(e):e;if(n&&"collection"===n.type){const e=t[n.collectionId];if(e)return e}return l}(t);return i?s.createElement(a,{text:i}):null!=n&&n.properties?s.createElement(a,{text:`${n.properties.name} - ${n.properties.description}`}):s.createElement(f,null)}function f(){const e=(0,c.q)(d);return s.createElement(a,{text:e.unknown})}const d={en:{submittedFiles:"Your submitted files",unknown:"Unknown"},de:{submittedFiles:"Ihre eingereichten Dateien",unknown:"Unbekannt"}}},9356:function(e,t,n){n.d(t,{T:function(){return c}});var s=n(7294),r=n(3097);function c({id:e}){return s.createElement("span",{className:"LoaderAnimation",id:e}," ",s.createElement(r.JO,{kind:"loader-5-line"}),s.createElement(r.JO,{kind:"loader-5-line"}))}},8557:function(e,t,n){n.d(t,{Vl:function(){return k},O6:function(){return w},sJ:function(){return h},u$:function(){return v}});var s=n(1082),r=n(7294),c=n(603),o=n(1513);function l(e){const t={items:[],collections:new Map,invalid:[]};function n(e,n,s){const r=o.f.stringify({type:"collection",collectionId:n.collectionId});let c=t.collections.get(r);void 0===c&&(c=[],t.collections.set(r,c)),c.push({item:e,document:n,result:s})}for(const i of e){var s,r,c,l;const e=o.f.tryParse(null!==(s=null===(r=i.resources)||void 0===r?void 0:r.urnA)&&void 0!==s?s:""),a=o.f.tryParse(null!==(c=null===(l=i.resources)||void 0===l?void 0:l.urnB)&&void 0!==c?c:"");e&&a?"item"===e.type&&"item"===a.type?t.items.push({a:e,b:a,result:i}):"item"===e.type&&"document"===a.type?n(e,a,i):"document"===e.type&&"item"===a.type?n(a,e,i):t.invalid.push(i):t.invalid.push(i)}return t}var i=n(478),a=n(6627);function u({kind:e,children:t}){return r.createElement("span",{className:`Badge ${e}`},t)}var m=n(4761),f=n(5818),d=n(3097),p=n(2503),E=n(9356);function h({backTo:e,title:t,children:n}){const c=(0,a.q)(y);return r.createElement("div",{className:"OverviewContainer"},r.createElement("div",{className:"head"},e&&r.createElement(s.rU,{className:m.E.BUTTON,to:e,title:c.back},r.createElement(d.fd,{kind:"back"})),r.createElement("div",null,t)),r.createElement("div",{className:"content"},n))}function v({session:e,collections:t,selectedCollections:n,backTo:o,itemTo:i,collectionTo:d}){const v=(0,a.q)(y),w=l(e.resultsList);for(const s of n){var k;w.collections.set(s,null!==(k=w.collections.get(s))&&void 0!==k?k:[])}w.invalid.length&&(console.error("Not displaying the following results:"),console.error(w.invalid));const T=r.createElement(f.r,{grow:"left",left:r.createElement(p.__,{icon:"results",text:v.analysisResults}),right:r.createElement(u,{kind:"Dark"},v.results)}),N=e.status===c.Session.ComputeStatus.STATUS_RUNNING;return r.createElement("div",{className:"ResultsOverview"},r.createElement(h,{backTo:o,title:T},r.createElement("div",null,r.createElement(s.rU,{className:m.E.BUTTON,to:i},r.createElement(f.r,{grow:"left",left:r.createElement(p.Rk,null),right:r.createElement(u,{kind:"Light"},N&&r.createElement(E.T,null),w.items.length)}))),[...w.collections].map((([n,c])=>r.createElement("div",{key:n},r.createElement(g,{sessionUrn:e.urn,results:c}),r.createElement(s.rU,{className:m.E.BUTTON,to:d(n)},r.createElement(f.r,{grow:"left",left:r.createElement(p.hu,{collectionUrn:n,collections:t}),right:r.createElement(u,{kind:"Light"},c.length)})))))))}function g({sessionUrn:e,results:t}){return(0,i.x)(e,t.map((e=>o.f.stringify(e.document)))),r.createElement(r.Fragment,null)}function w({session:e,backTo:t,resultTo:n}){const o=(0,a.q)(y),{items:i}=l(e.resultsList),d=r.createElement(f.r,{grow:"left",left:r.createElement(p.Rk,null),right:r.createElement(u,{kind:"Dark"},o.matches)}),v=new Map(e.itemsList.map((e=>{var t;return[e.urn,null===(t=e.meta)||void 0===t?void 0:t.name]})));return r.createElement("div",{className:"ItemResultsOverview"},r.createElement(h,{backTo:t,title:d},i.map((({result:t})=>{var l,i,a,d,p,h;const g=null!==(l=v.get(null!==(i=null===(a=t.resources)||void 0===a?void 0:a.urnA)&&void 0!==i?i:""))&&void 0!==l?l:o.unknownItem,w=null!==(d=v.get(null!==(p=null===(h=t.resources)||void 0===h?void 0:h.urnB)&&void 0!==p?p:""))&&void 0!==d?d:o.unknownItem;return r.createElement("div",{key:t.urn},r.createElement(s.rU,{className:m.E.BUTTON,to:n(t)},r.createElement(f.r,{grow:"left",left:r.createElement("span",{className:"item-vs"},r.createElement("span",{className:"left"},g),r.createElement("span",{className:"vs"},"vs."),r.createElement("span",{className:"right"},w)),right:e.status===c.Session.ComputeStatus.STATUS_COMPLETED?r.createElement(u,{kind:"Light"},t.seedsList.length):r.createElement(E.T,null)})))})),0===i.length&&r.createElement("div",{className:"no-results"},o.noResults)))}function k({session:e,collectionUrn:t,collections:n,backTo:i,resultTo:d}){var v;const g=(0,a.q)(y),w=null!==(v=l(e.resultsList).collections.get(t))&&void 0!==v?v:[],k=r.createElement(f.r,{grow:"left",left:r.createElement(p.hu,{collectionUrn:t,collections:n}),right:r.createElement(u,{kind:"Dark"},g.matches)}),N=new Map(e.itemsList.map((e=>{var t;return[e.urn,null===(t=e.meta)||void 0===t?void 0:t.name]})));return r.createElement("div",{className:"CollectionResultsOverview"},r.createElement(h,{backTo:i,title:k},w.map((({item:t,document:n,result:l})=>{var i;const a=null!==(i=N.get(o.f.stringify(t)))&&void 0!==i?i:g.unknownItem,p=r.createElement(T,{sessionUrn:e.urn,urn:o.f.stringify(n)});return r.createElement("div",{key:l.urn},r.createElement(s.rU,{className:m.E.BUTTON,to:d(l)},r.createElement(f.r,{grow:"left",left:r.createElement("span",{className:"item-vs"},r.createElement("span",{className:"left"},a),r.createElement("span",{className:"vs"},"vs."),r.createElement("span",{className:"right"},p)),right:e.status===c.Session.ComputeStatus.STATUS_COMPLETED?r.createElement(u,{kind:"Light"},l.seedsList.length):r.createElement(E.T,null)})))})),0===w.length&&r.createElement("div",{className:"no-results"},g.noResults)))}function T({sessionUrn:e,urn:t}){const n=(0,i.e)(e,t);var s;return null!=n&&n.properties?r.createElement(r.Fragment,null,null===(s=n.properties)||void 0===s?void 0:s.title):r.createElement(E.T,null)}const y={en:{back:"Back",analysisResults:"Analysis results",results:"Results",matches:"Matches",noResults:"No results",unknownItem:"<unknown>"},de:{back:"Zurück",analysisResults:"Analyse­ergebnisse",results:"Ergebnisse",matches:"Treffer",noResults:"Keine Ergebnisse",unknownItem:"<unbekannt>"}}},1878:function(e,t,n){n.d(t,{n0:function(){return E},Px:function(){return m}});var s=n(1082),r=n(7294),c=n(4831),o=n(6627),l=n(5461),i=n(4761);function a({heading:e,children:t}){return r.createElement("div",{className:"Group"},r.createElement("div",{className:"group-heading"},e),r.createElement("div",{className:"group-container"},t))}var u=n(3097);function m(e,t){switch(e){case"submit":return(0,c.me)({urn:t});case"analysis":return(0,c.sF)({urn:t});case"checkout":return"/checkout/";case"results":return(0,c.bq)({urn:t});default:(0,l.vE)(e)}}const f=["submit","analysis","checkout","results"],d={submit:"upload",analysis:"analyse",checkout:"checkout",results:"results"};function p({current:e,sessionUrn:t,disableOthers:n}){const c=(0,o.q)(h);return r.createElement("span",{className:`StepSelector ${i.E.BUTTON_GROUP}`},f.filter((e=>"checkout"!==e)).map((o=>{const l=c[o];return n&&o!==e?r.createElement("span",{key:o,className:`${i.E.BUTTON} ${i.E.DISABLED}`,title:l},r.createElement(u.fd,{kind:d[o]}),r.createElement("span",{className:"text"},l)):r.createElement(s.rU,{key:o,to:m(o,t),className:`${i.E.BUTTON}${o===e?" "+i.E.ACTIVE:""}`,title:l},r.createElement(u.fd,{kind:d[o]}),r.createElement("span",{className:"text"},l))})))}function E({current:e,sessionUrn:t,disableOthers:n,children:s}){return r.createElement("div",{className:"StepSelectorGroup"},r.createElement(a,{heading:r.createElement("div",{className:"heading-wrapper"},r.createElement(p,{current:e,sessionUrn:t,disableOthers:n}))},s))}const h={en:{submit:"Upload",analysis:"Analysis",checkout:"Checkout",results:"Results"},de:{submit:"Hochladen",analysis:"Analyse",checkout:"Kasse",results:"Ergebnisse"}}},495:function(e,t,n){function s(e){return JSON.parse(JSON.stringify(e))}function r(){const e=Date.now();return{seconds:Math.floor(e/1e3),nanos:e%1e3*1e7}}function c(e,t){return e.seconds===t.seconds?e.nanos-t.nanos:e.seconds-t.seconds}function o(e){return[...e].sort(((e,t)=>{const n=e.createdAt,s=t.createdAt;return n||s?n?s?c(n,s)||e.urn.localeCompare(t.urn):1:-1:0}))}n.d(t,{R3:function(){return s},VN:function(){return r},a$:function(){return o},pv:function(){return c}})},4141:function(e,t,n){n.d(t,{b:function(){return a}});var s=n(7294),r=n(6006),c=n(5461),o=n(1513);class l{constructor(e,t,n){this.groupA=e,this.groupB=t,this.collections=n}withGroupA(e){return new l(e,this.groupB,this.collections)}withGroupB(e){return new l(this.groupA,e,this.collections)}withCollections(e){return new l(this.groupA,this.groupB,e)}withCollection(e,t){const n=new Map(this.collections);return n.set(e,t),this.withCollections(n)}static fromResourcePairs(e,t){const n=new Set,s=new Set,c=new Map;function o(e,t){let n=c.get(e);void 0===n&&(n=new Set,c.set(e,n)),n.add(t)}function a(e){const n=i(e);return"item"===n?[e]:"session"===n?t:[]}for(const l of e){const[e,t]=l instanceof r.ResourcePair?[l.getUrnA(),l.getUrnB()]:[l.urnA,l.urnB],c=i(e),u=i(t);"collection"!==c?"collection"!==u?(a(e).forEach((e=>n.add(e))),a(t).forEach((e=>s.add(e)))):a(e).forEach((e=>o(t,e))):a(t).forEach((t=>o(e,t)))}return new l(n,s,c)}getResourcePairs(){const e=[],t=new Set,n=new Set;for(const s of this.groupA)for(const c of this.groupB)s===c||(t.add(s),n.add(c),e.push((new r.ResourcePair).setUrnA(s).setUrnB(c)));for(const s of this.groupA)t.has(s)||e.push((new r.ResourcePair).setUrnA(s).setUrnB(o.s));for(const s of this.groupB)n.has(s)||e.push((new r.ResourcePair).setUrnA(o.s).setUrnB(s));for(const[s,c]of this.collections)for(const t of c)e.push((new r.ResourcePair).setUrnA(s).setUrnB(t));return e}}function i(e){try{return o.f.parse(e).type}catch(t){return}}function a(e){return(0,s.useMemo)((()=>{var t;return"Ready"===e.type?l.fromResourcePairs(null!==(t=e.session.comparisonsList)&&void 0!==t?t:c.LZ,e.session.itemsList.map((e=>e.urn))):l.EMPTY}),[e])}(l||(l={})).EMPTY=new l(c.a4,c.a4,c.wO)},478:function(e,t,n){n.d(t,{e:function(){return i},x:function(){return a}});var s=n(3467),r=n(603),c=n(693);async function o(e){const[,t,n]=e.queryKey,s=new r.GetDocumentRequest;s.setSessionUrn(t),s.setDocumentUrn(n);return(await(0,c.M)().getDocument(s,null)).toObject().document}function l(e,t){return{queryKey:["collection-document",e,t],queryFn:o,refetchInterval:!1,refetchOnMount:!1,refetchOnReconnect:!1,refetchOnWindowFocus:!1}}function i(e,t){const n=l(e,t);return(0,s.useQuery)(n.queryKey,n).data}function a(e,t){(0,s.useQueries)(t.map((t=>l(e,t))))}},7339:function(e,t,n){n.d(t,{b:function(){return o}});var s=n(3467),r=n(603),c=n(693);function o(e){return[(0,s.useQuery)(["collections",e],{refetchInterval:!1,refetchOnMount:!1,refetchOnReconnect:!1,refetchOnWindowFocus:!1,queryFn:async()=>{const t=new r.GetCollectionsRequest;t.setSessionUrn(e);return(await(0,c.M)().getCollections(t,null)).toObject().collectionsList}}).data]}},9774:function(e,t,n){n.r(t),n.d(t,{Head:function(){return T},default:function(){return y}});var s=n(7294),r=n(6208),c=n(8557),o=n(7601),l=n(8252),i=n(1878),a=n(603),u=n(4831),m=n(9067),f=n(6120),d=n(4141),p=n(7339),E=n(693),h=n(495),v=n(5461);const g=e=>{if(e.status===a.Session.ComputeStatus.STATUS_UNDEFINED){const t=(0,h.R3)(e);return t.status=a.Session.ComputeStatus.STATUS_RUNNING,t}return e};var w=n(6627),k=n(4918);const T=()=>s.createElement(s.Fragment,null,s.createElement("title",null,"Picapica"),s.createElement("meta",{name:"robots",content:"noindex"}),s.createElement(l.s,null));var y=(0,m.kj)((function(){const e=(0,w.q)(R),[t,n]=(0,k.zU)();!function(e,t){const[n,r]=(0,s.useState)(0);(0,m.bd)((async s=>{if("Ready"!==e.type)return;const{session:c}=e;if(c.status===a.Session.ComputeStatus.STATUS_RUNNING)return;if(c.status===a.Session.ComputeStatus.STATUS_COMPLETED||c.status===a.Session.ComputeStatus.STATUS_FAILED){const{computedAt:e,modifiedAt:t}=c;if((0,h.pv)(e,t)>=0)return}n>0&&(await(0,v.gw)(3e3),s.checkCanceled());const o=new a.ComputeResultsRequest;o.setSessionUrn(c.urn),console.log("Compute results");const l=(0,E.M)().computeResults(o,null).then((()=>{t(l,g),r(0)}),(e=>{throw r((e=>e+1)),e})).catch(console.log)}),v.ZT,v.ZT,[e,t,n,r])}(t,n);const[l]=(0,p.b)((0,k.PK)(t)),T=function(){const e=(0,f.Ee)().get("view");return e?function(e){if(e){if("items"===e)return U;const t=/^collection:([^]+)$/.exec(e);if(t)return{type:"collection",collectionUrn:t[1]}}return N}(e):N}(),y=e=>(0,u.K8)({urn:e.urn,view:b(T)}),A=(0,d.b)(t),O=(0,s.useMemo)((()=>[...A.collections].filter((e=>e[1].size>0)).map((e=>e[0]))),[A]);return s.createElement(r.T,{className:"Results",title:e.title,header:"small"},s.createElement(o.sM,{state:t,onReady:({session:t})=>{const n=(0,v.Gi)(T,{overview:()=>s.createElement(c.u$,{session:t,collections:l,selectedCollections:O,backTo:(0,i.Px)("analysis",t.urn),itemTo:S(t.urn,U),collectionTo:e=>S(t.urn,{type:"collection",collectionUrn:e})}),items:()=>s.createElement(c.O6,{session:t,backTo:S(t.urn,N),resultTo:y}),collection:({collectionUrn:e})=>s.createElement(c.Vl,{collectionUrn:e,session:t,collections:l,backTo:S(t.urn,N),resultTo:y})}),r=t.status===a.Session.ComputeStatus.STATUS_RUNNING;return s.createElement(s.Fragment,null,n,s.createElement("p",{className:"loading",style:r?{}:{opacity:0,userSelect:"none"}},e.running))}}))}));const N={type:"overview"},U={type:"items"};function b(e){return"items"===e.type?"items":"collection"===e.type?`collection:${e.collectionUrn}`:void 0}function S(e,t){return(0,u.bq)({urn:e,view:b(t)})}const R={en:{title:"Results - Picapica",running:"Your submitted files are currently being processed. This might take a few seconds."},de:{title:"Ergebnisse - Picapica",running:"Ihre Eingabe wird bearbeitet. Dies kann ein paar Sekunden dauern."}}}}]);
//# sourceMappingURL=component---src-pages-results-tsx-d3c93a8b2c10c7d8922a.js.map