{"version":3,"file":"component---src-pages-result-tsx-6e0cb55243fef71fce29.js","mappings":"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","sources":["webpack://picapica-web-client/./src/elements/alignment-view.tsx","webpack://picapica-web-client/./src/elements/center-align-two.tsx","webpack://picapica-web-client/./src/lib/use-collection-localization.ts","webpack://picapica-web-client/./src/elements/labels.tsx","webpack://picapica-web-client/./src/elements/loader-animation.tsx","webpack://picapica-web-client/./src/lib/session/result-categories.ts","webpack://picapica-web-client/./src/elements/badge.tsx","webpack://picapica-web-client/./src/elements/results-overview.tsx","webpack://picapica-web-client/./src/lib/lru-cache.ts","webpack://picapica-web-client/./src/lib/use-alignment.ts","webpack://picapica-web-client/./src/lib/use-result-text.ts","webpack://picapica-web-client/./src/pages/result.tsx","webpack://picapica-web-client/./src/lib/use-collection-document.ts"],"sourcesContent":["import React, { memo } from \"react\";\nimport { LeftChange, RightChange } from \"../lib/alignment\";\nimport { Locales } from \"../lib/localization\";\nimport { useAlignment } from \"../lib/use-alignment\";\nimport { useLocalization } from \"../lib/use-localization\";\nimport \"./alignment-view.scss\";\n\nexport interface Props {\n\treadonly left: string;\n\treadonly right: string;\n\treadonly alignmentKey: string;\n}\n\nexport const AlignmentView = memo((props: Props): JSX.Element => {\n\tconst [alignments] = useAlignment(props.alignmentKey, [props]);\n\n\tconst diff = alignments[0]?.diff?.diff;\n\n\treturn (\n\t\t<div className=\"AlignmentView\">\n\t\t\t{diff ? (\n\t\t\t\t<>\n\t\t\t\t\t{diff.map(({ left }, i) => {\n\t\t\t\t\t\treturn <DiffView key={\"l\" + i} left={left} index={i} total={diff.length} />;\n\t\t\t\t\t})}\n\t\t\t\t\t{diff.map(({ right }, i) => {\n\t\t\t\t\t\treturn <DiffView key={\"r\" + i} right={right} index={i} total={diff.length} />;\n\t\t\t\t\t})}\n\t\t\t\t</>\n\t\t\t) : (\n\t\t\t\t<>\n\t\t\t\t\t<div className=\"left\" style={{ gridRow: 1 }}>\n\t\t\t\t\t\t<span>{props.left}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"right\" style={{ gridRow: 1 }}>\n\t\t\t\t\t\t<span>{props.right}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</div>\n\t);\n});\n\ninterface DiffLineProps {\n\tindex: number;\n\ttotal: number;\n}\nfunction DiffView(props: ({ left: LeftChange<string> } | { right: RightChange<string> }) & DiffLineProps): JSX.Element {\n\tlet equal: string;\n\tlet changed: string;\n\tlet type: \"left\" | \"right\";\n\tif (\"left\" in props) {\n\t\tequal = props.left.equal;\n\t\tchanged = props.left.removed;\n\t\ttype = \"left\";\n\t} else {\n\t\tequal = props.right.equal;\n\t\tchanged = props.right.added;\n\t\ttype = \"right\";\n\t}\n\n\tconst changedClass = type === \"left\" ? \"removed\" : \"added\";\n\n\treturn (\n\t\t<div className={type} style={{ gridRow: props.index + 1 }}>\n\t\t\t{equal !== \"\" ? (\n\t\t\t\t<>\n\t\t\t\t\t<span className=\"unchanged\">{equal.trim()}</span>\n\t\t\t\t\t{/\\s$/.test(equal) ? \" \" : \"\"}\n\t\t\t\t\t<Change {...props} type={changedClass} text={changed} isFirst={false} />\n\t\t\t\t</>\n\t\t\t) : (\n\t\t\t\t<Change {...props} type={changedClass} text={changed} isFirst={true} />\n\t\t\t)}\n\t\t</div>\n\t);\n}\n\ninterface ChangeProps {\n\ttext: string;\n\ttype: \"added\" | \"removed\";\n\tindex: number;\n\ttotal: number;\n\tisFirst: boolean;\n}\nfunction Change(props: ChangeProps): JSX.Element {\n\tconst text = props.text;\n\n\tconst context = 500;\n\tconst minOmitted = 20;\n\n\tconst isLast = props.index === props.total - 1;\n\tif (isLast && text.length > context) {\n\t\tconst tokens = tokenizeWords(text);\n\t\tconst rest = splitRest(tokens, context);\n\t\tif (rest.length > minOmitted) {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t<span className={props.type}>\n\t\t\t\t\t\t<FadeText text={tokens.join(\" \").trim()} position=\"end\" />\n\t\t\t\t\t</span>\n\t\t\t\t\t<Omitted words={rest.length} />\n\t\t\t\t</>\n\t\t\t);\n\t\t}\n\t} else if (props.isFirst && text.length > context) {\n\t\tconst tokens = tokenizeWords(text).reverse();\n\t\tconst rest = splitRest(tokens, context);\n\t\tif (rest.length > minOmitted) {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t<Omitted words={rest.length} />\n\t\t\t\t\t<span className={props.type}>\n\t\t\t\t\t\t<FadeText text={tokens.reverse().join(\" \").trim()} position=\"start\" />\n\t\t\t\t\t</span>\n\t\t\t\t</>\n\t\t\t);\n\t\t}\n\t} else if (text.length > context * 2) {\n\t\tconst start = tokenizeWords(text);\n\t\tconst end = splitRest(start, context).reverse();\n\t\tconst rest = splitRest(end, context);\n\n\t\tif (rest.length > minOmitted) {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t<span className={props.type}>\n\t\t\t\t\t\t<FadeText text={start.join(\" \").trim()} position=\"end\" />\n\t\t\t\t\t</span>\n\t\t\t\t\t<Omitted words={rest.length} />\n\t\t\t\t\t<span className={props.type}>\n\t\t\t\t\t\t<FadeText text={end.reverse().join(\" \").trim()} position=\"start\" />\n\t\t\t\t\t</span>\n\t\t\t\t</>\n\t\t\t);\n\t\t}\n\t}\n\n\treturn <span className={props.type}>{props.text}</span>;\n}\nfunction tokenizeWords(text: string): string[] {\n\treturn text.split(/ /g);\n}\nfunction splitRest(tokens: string[], stringLength: number): string[] {\n\tlet length = 0;\n\tfor (let i = 0; i < tokens.length; i++) {\n\t\tlength += tokens[i].length;\n\t\tif (length >= stringLength) {\n\t\t\treturn tokens.splice(i + 1, tokens.length - i - 1);\n\t\t}\n\t}\n\n\treturn [];\n}\n\ninterface FadeTextProps {\n\ttext: string;\n\tposition: \"start\" | \"end\";\n}\nfunction FadeText(props: FadeTextProps): JSX.Element {\n\tconst fadeLength = 10;\n\n\tconst chars = [...props.text];\n\tif (chars.length < fadeLength) {\n\t\t// fail safe\n\t\treturn <>{props.text}</>;\n\t}\n\n\tconst fade =\n\t\tprops.position === \"start\" ? chars.splice(0, fadeLength) : chars.splice(chars.length - fadeLength, fadeLength);\n\tconst text = chars.join(\"\");\n\n\tif (props.position === \"start\") {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{fade.map((c, i) => (\n\t\t\t\t\t<span key={i} className=\"fade\" style={{ opacity: i / fadeLength }}>\n\t\t\t\t\t\t{c}\n\t\t\t\t\t</span>\n\t\t\t\t))}\n\t\t\t\t{text}\n\t\t\t</>\n\t\t);\n\t} else {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{text}\n\t\t\t\t{fade.map((c, i) => (\n\t\t\t\t\t<span key={i} className=\"fade\" style={{ opacity: (fadeLength - i) / fadeLength }}>\n\t\t\t\t\t\t{c}\n\t\t\t\t\t</span>\n\t\t\t\t))}\n\t\t\t</>\n\t\t);\n\t}\n}\n\ninterface OmittedProps {\n\twords: number;\n}\nfunction Omitted(props: OmittedProps): JSX.Element {\n\tconst l = useLocalization(locales);\n\treturn <span className=\"Omitted\"> [{l.omitted(props.words)}] </span>;\n}\n\nconst locales: Locales<{\n\tomitted: (words: number) => JSX.Element;\n}> = {\n\ten: {\n\t\tomitted(words) {\n\t\t\treturn <>… {words} words omitted</>;\n\t\t},\n\t},\n\tde: {\n\t\tomitted(words) {\n\t\t\treturn <>… {words} Wörter weggelassen</>;\n\t\t},\n\t},\n};\n","import React from \"react\";\nimport \"./center-align-two.scss\";\n\nexport interface CenterAlignTwoProps {\n\treadonly className?: string;\n\treadonly grow: \"left\" | \"right\";\n\treadonly left: React.ReactNode;\n\treadonly right: React.ReactNode;\n}\n\nexport function CenterAlignTwo({ className, grow, left, right }: CenterAlignTwoProps): JSX.Element {\n\treturn (\n\t\t<div className={\"CenterAlignTwo\" + (className ? \" \" + className : \"\")}>\n\t\t\t<div className={`left${grow === \"left\" ? \" grow\" : \"\"}`}>{left}</div>\n\t\t\t<div className={`right${grow === \"right\" ? \" grow\" : \"\"}`}>{right}</div>\n\t\t</div>\n\t);\n}\n","import { Locales } from \"./localization\";\nimport { PicapicaUrn } from \"./session/urn\";\nimport { useLocalization } from \"./use-localization\";\n\nexport interface CollectionLocalization {\n\treadonly title: string;\n}\n\ntype KnownCollections = \"core_fulltext_languagenameenglish\";\n\nconst knownCollections: Locales<Record<KnownCollections, CollectionLocalization>> = {\n\ten: {\n\t\tcore_fulltext_languagenameenglish: {\n\t\t\ttitle: \"CORE - The world's largest collection of open-access research papers\",\n\t\t},\n\t},\n\tde: {\n\t\tcore_fulltext_languagenameenglish: {\n\t\t\ttitle: \"CORE - The world's largest collection of open-access research papers\",\n\t\t},\n\t},\n};\n\nconst EMPTY_OBJ = {};\n\nexport function useCollectionLocalization(\n\turn: PicapicaUrn | string | undefined | null\n): Partial<CollectionLocalization> {\n\tconst l: Readonly<Record<string, CollectionLocalization | undefined>> = useLocalization(knownCollections);\n\n\tconst parsed = typeof urn === \"string\" ? PicapicaUrn.tryParse(urn) : urn;\n\tif (parsed && parsed.type === \"collection\") {\n\t\tconst known = l[parsed.collectionId];\n\t\tif (known) {\n\t\t\treturn known;\n\t\t}\n\t}\n\n\treturn EMPTY_OBJ;\n}\n","import React from \"react\";\nimport { Collection } from \"../lib/generated/v1/types_pb\";\nimport { Locales, SimpleString } from \"../lib/localization\";\nimport { PicapicaCollectionUrn, PicapicaUrn, Urn } from \"../lib/session/urn\";\nimport { useCollectionLocalization } from \"../lib/use-collection-localization\";\nimport { useLocalization } from \"../lib/use-localization\";\nimport { DeepReadonly } from \"../lib/util\";\nimport { PicaIcon, PicaIconKind } from \"./icon\";\nimport \"./labels.scss\";\n\nexport interface LabelProps {\n\treadonly icon?: PicaIconKind;\n\treadonly text: string;\n}\n\nexport function Label(props: LabelProps): JSX.Element {\n\treturn (\n\t\t<span className=\"Label\">\n\t\t\t{props.icon && <PicaIcon kind={props.icon} />}\n\t\t\t<span className=\"text\">{props.text}</span>\n\t\t</span>\n\t);\n}\n\nexport function SubmittedFilesLabel(): JSX.Element {\n\tconst l = useLocalization(locales);\n\treturn <Label icon=\"upload\" text={l.submittedFiles} />;\n}\n\nexport type CollectionProps =\n\t| {\n\t\t\treadonly collectionUrn: string | PicapicaCollectionUrn;\n\t\t\treadonly collections?: DeepReadonly<Collection.AsObject[]>;\n\t  }\n\t| {\n\t\t\treadonly collection: DeepReadonly<Collection.AsObject>;\n\t  };\n\nexport function CollectionLabel(props: CollectionProps): JSX.Element {\n\tconst { urn, collection } = processProps(props);\n\tconst { title } = useCollectionLocalization(urn);\n\n\tif (title) {\n\t\treturn <Label text={title} />;\n\t} else if (collection?.properties) {\n\t\treturn <Label text={`${collection.properties.name} - ${collection.properties.description}`} />;\n\t} else {\n\t\treturn <UnknownCollectionLabel />;\n\t}\n}\ninterface ProcessedProps {\n\turn: PicapicaCollectionUrn | undefined;\n\tcollection: DeepReadonly<Collection.AsObject> | undefined;\n}\nfunction processProps(props: CollectionProps): ProcessedProps {\n\tif (\"collection\" in props) {\n\t\treturn {\n\t\t\turn: PicapicaUrn.parse(props.collection.urn as Urn<\"collection\">),\n\t\t\tcollection: props.collection,\n\t\t};\n\t} else {\n\t\tlet urn: PicapicaCollectionUrn;\n\t\tlet urnString: string;\n\t\tif (typeof props.collectionUrn === \"string\") {\n\t\t\tconst parsed = PicapicaUrn.tryParse(props.collectionUrn);\n\t\t\tif (!parsed || parsed.type !== \"collection\") {\n\t\t\t\treturn { urn: undefined, collection: undefined };\n\t\t\t}\n\t\t\turn = parsed;\n\t\t\turnString = props.collectionUrn;\n\t\t} else {\n\t\t\turn = props.collectionUrn;\n\t\t\turnString = PicapicaUrn.stringify(urn);\n\t\t}\n\n\t\tconst collection = props.collections?.find(c => c.urn === urnString);\n\n\t\treturn { urn, collection };\n\t}\n}\n\nfunction UnknownCollectionLabel(): JSX.Element {\n\tconst l = useLocalization(locales);\n\treturn <Label text={l.unknown} />;\n}\n\nconst locales: Locales<SimpleString<\"submittedFiles\" | \"unknown\">> = {\n\ten: {\n\t\tsubmittedFiles: \"Your submitted files\",\n\t\tunknown: \"Unknown\",\n\t},\n\tde: {\n\t\tsubmittedFiles: \"Ihre eingereichten Dateien\",\n\t\tunknown: \"Unbekannt\",\n\t},\n};\n","import React from \"react\";\nimport { Icon } from \"./icon\";\nimport \"./loader-animation.scss\";\n\nexport interface LoaderAnimationProps {\n\treadonly id?: string;\n}\n\nexport function LoaderAnimation({ id }: LoaderAnimationProps): JSX.Element {\n\treturn (\n\t\t<span className=\"LoaderAnimation\" id={id}>\n\t\t\t{\" \"}\n\t\t\t<Icon kind=\"loader-5-line\" />\n\t\t\t<Icon kind=\"loader-5-line\" />\n\t\t</span>\n\t);\n}\n","import { Result } from \"../generated/v1/types_pb\";\nimport { DeepReadonly } from \"../util\";\nimport { PicapicaDocumentUrn, PicapicaItemUrn, PicapicaUrn, Urn } from \"./urn\";\n\nexport interface ItemResult {\n\treadonly a: PicapicaItemUrn;\n\treadonly b: PicapicaItemUrn;\n\treadonly result: DeepReadonly<Result.AsObject>;\n}\nexport interface CollectionResult {\n\treadonly item: PicapicaItemUrn;\n\treadonly document: PicapicaDocumentUrn;\n\treadonly result: DeepReadonly<Result.AsObject>;\n}\n\nexport interface ResultCategories {\n\t/**\n\t * A list of all results between items.\n\t */\n\titems: ItemResult[];\n\t/**\n\t * A map from a collections URN to a non-empty list of results between an item and a document from key collection.\n\t */\n\tcollections: Map<Urn<\"collection\">, CollectionResult[]>;\n\t/**\n\t * A list of results that are invalid by not having valid URNs.\n\t */\n\tinvalid: DeepReadonly<Result.AsObject>[];\n}\n\nexport function categorizeResults(results: Iterable<DeepReadonly<Result.AsObject>>): ResultCategories {\n\tconst categories: ResultCategories = { items: [], collections: new Map(), invalid: [] };\n\n\tfunction addDocument(\n\t\titem: PicapicaItemUrn,\n\t\tdocument: PicapicaDocumentUrn,\n\t\tresult: DeepReadonly<Result.AsObject>\n\t): void {\n\t\tconst collectionUrn = PicapicaUrn.stringify({ type: \"collection\", collectionId: document.collectionId });\n\n\t\tlet list = categories.collections.get(collectionUrn);\n\t\tif (list === undefined) {\n\t\t\tlist = [];\n\t\t\tcategories.collections.set(collectionUrn, list);\n\t\t}\n\t\tlist.push({ item, document, result });\n\t}\n\n\tfor (const result of results) {\n\t\tconst a = PicapicaUrn.tryParse(result.resources?.urnA ?? \"\");\n\t\tconst b = PicapicaUrn.tryParse(result.resources?.urnB ?? \"\");\n\n\t\tif (!a || !b) {\n\t\t\tcategories.invalid.push(result);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (a.type === \"item\" && b.type === \"item\") {\n\t\t\tcategories.items.push({ a, b, result });\n\t\t} else if (a.type === \"item\" && b.type === \"document\") {\n\t\t\taddDocument(a, b, result);\n\t\t} else if (a.type === \"document\" && b.type === \"item\") {\n\t\t\taddDocument(b, a, result);\n\t\t} else {\n\t\t\tcategories.invalid.push(result);\n\t\t}\n\t}\n\n\treturn categories;\n}\n","import React from \"react\";\nimport \"./badge.scss\";\n\nexport type BadgeKind = \"Dark\" | \"Light\";\n\nexport interface BadgeProps {\n\treadonly kind: BadgeKind;\n}\n\nexport function Badge({ kind, children }: React.PropsWithChildren<BadgeProps>): JSX.Element {\n\treturn <span className={`Badge ${kind}`}>{children}</span>;\n}\n","import { Link } from \"gatsby\";\nimport React from \"react\";\nimport { Session } from \"../lib/generated/v1/services_pb\";\nimport { Collection, Result } from \"../lib/generated/v1/types_pb\";\nimport { Locales, SimpleString } from \"../lib/localization\";\nimport { categorizeResults } from \"../lib/session/result-categories\";\nimport { PicapicaUrn, Urn } from \"../lib/session/urn\";\nimport { useLocalization } from \"../lib/use-localization\";\nimport { DeepReadonly } from \"../lib/util\";\nimport { Badge } from \"./badge\";\nimport { Buttons } from \"./buttons\";\nimport { CenterAlignTwo } from \"./center-align-two\";\nimport { PicaIcon } from \"./icon\";\nimport { CollectionLabel, Label, SubmittedFilesLabel } from \"./labels\";\nimport { LoaderAnimation } from \"./loader-animation\";\nimport \"./results-overview.scss\";\n\nexport interface OverviewContainerProps {\n\treadonly backTo?: string;\n\treadonly title: React.ReactNode;\n}\n\nexport function OverviewContainer({\n\tbackTo,\n\ttitle,\n\tchildren,\n}: React.PropsWithChildren<OverviewContainerProps>): JSX.Element {\n\tconst l = useLocalization(locales);\n\n\treturn (\n\t\t<div className=\"OverviewContainer\">\n\t\t\t<div className=\"head\">\n\t\t\t\t{backTo && (\n\t\t\t\t\t<Link className={Buttons.BUTTON} to={backTo} title={l.back}>\n\t\t\t\t\t\t<PicaIcon kind=\"back\" />\n\t\t\t\t\t</Link>\n\t\t\t\t)}\n\t\t\t\t<div>{title}</div>\n\t\t\t</div>\n\t\t\t<div className=\"content\">{children}</div>\n\t\t</div>\n\t);\n}\n\nexport interface ResultsOverviewProps {\n\treadonly session: DeepReadonly<Session.AsObject>;\n\treadonly collections?: DeepReadonly<Collection.AsObject[]>;\n\treadonly backTo: string;\n\treadonly itemTo: string;\n\treadonly collectionTo: (collectionUrn: string) => string;\n}\n\nexport function ResultsOverview({\n\tsession,\n\tcollections,\n\tbackTo,\n\titemTo,\n\tcollectionTo,\n}: ResultsOverviewProps): JSX.Element {\n\tconst l = useLocalization(locales);\n\n\tconst categories = categorizeResults(session.resultsList);\n\n\tif (categories.invalid.length) {\n\t\tconsole.error(\"Not displaying the following results:\");\n\t\tconsole.error(categories.invalid);\n\t}\n\n\tconst title = (\n\t\t<CenterAlignTwo\n\t\t\tgrow=\"left\"\n\t\t\tleft={<Label icon=\"results\" text={l.analysisResults} />}\n\t\t\tright={<Badge kind=\"Dark\">{l.results}</Badge>}\n\t\t/>\n\t);\n\n\tconst running = session.status === Session.ComputeStatus.STATUS_RUNNING;\n\n\treturn (\n\t\t<div className=\"ResultsOverview\">\n\t\t\t<OverviewContainer backTo={backTo} title={title}>\n\t\t\t\t<div>\n\t\t\t\t\t<Link className={Buttons.BUTTON} to={itemTo}>\n\t\t\t\t\t\t<CenterAlignTwo\n\t\t\t\t\t\t\tgrow=\"left\"\n\t\t\t\t\t\t\tleft={<SubmittedFilesLabel />}\n\t\t\t\t\t\t\tright={\n\t\t\t\t\t\t\t\t<Badge kind=\"Light\">\n\t\t\t\t\t\t\t\t\t{running && <LoaderAnimation />}\n\t\t\t\t\t\t\t\t\t{categories.items.length}\n\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Link>\n\t\t\t\t</div>\n\t\t\t\t{[...categories.collections].map(([urn, results]) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div key={urn}>\n\t\t\t\t\t\t\t<Link className={Buttons.BUTTON} to={collectionTo(urn)}>\n\t\t\t\t\t\t\t\t<CenterAlignTwo\n\t\t\t\t\t\t\t\t\tgrow=\"left\"\n\t\t\t\t\t\t\t\t\tleft={<CollectionLabel collectionUrn={urn} collections={collections} />}\n\t\t\t\t\t\t\t\t\tright={<Badge kind=\"Light\">{results.length}</Badge>}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</OverviewContainer>\n\t\t</div>\n\t);\n}\n\nexport interface ItemResultsOverviewProps {\n\treadonly session: DeepReadonly<Session.AsObject>;\n\treadonly backTo: string;\n\treadonly resultTo: (result: DeepReadonly<Result.AsObject>) => string;\n}\n\nexport function ItemResultsOverview({ session, backTo, resultTo }: ItemResultsOverviewProps): JSX.Element {\n\tconst l = useLocalization(locales);\n\n\tconst { items } = categorizeResults(session.resultsList);\n\n\tconst title = (\n\t\t<CenterAlignTwo grow=\"left\" left={<SubmittedFilesLabel />} right={<Badge kind=\"Dark\">{l.matches}</Badge>} />\n\t);\n\n\tconst itemNameMap = new Map(session.itemsList.map(item => [item.urn, item.meta?.name]));\n\n\treturn (\n\t\t<div className=\"ItemResultsOverview\">\n\t\t\t<OverviewContainer backTo={backTo} title={title}>\n\t\t\t\t{items.map(({ result }) => {\n\t\t\t\t\tconst leftName = itemNameMap.get(result.resources?.urnA ?? \"\") ?? l.unknownItem;\n\t\t\t\t\tconst rightName = itemNameMap.get(result.resources?.urnB ?? \"\") ?? l.unknownItem;\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div key={result.urn}>\n\t\t\t\t\t\t\t<Link className={Buttons.BUTTON} to={resultTo(result)}>\n\t\t\t\t\t\t\t\t<CenterAlignTwo\n\t\t\t\t\t\t\t\t\tgrow=\"left\"\n\t\t\t\t\t\t\t\t\tleft={\n\t\t\t\t\t\t\t\t\t\t<span className=\"item-vs\">\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"left\">{leftName}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"vs\">vs.</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"right\">{rightName}</span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tright={\n\t\t\t\t\t\t\t\t\t\tsession.status === Session.ComputeStatus.STATUS_COMPLETED ? (\n\t\t\t\t\t\t\t\t\t\t\t<Badge kind=\"Light\">{result.seedsList.length}</Badge>\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<LoaderAnimation />\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t})}\n\n\t\t\t\t{items.length === 0 && <div className=\"no-results\">{l.noResults}</div>}\n\t\t\t</OverviewContainer>\n\t\t</div>\n\t);\n}\n\nexport interface CollectionResultsOverviewProps {\n\treadonly collectionUrn: string;\n\treadonly session: DeepReadonly<Session.AsObject>;\n\treadonly collections?: DeepReadonly<Collection.AsObject[]>;\n\treadonly backTo: string;\n\treadonly resultTo: (result: DeepReadonly<Result.AsObject>) => string;\n}\n\nexport function CollectionResultsOverview({\n\tsession,\n\tcollectionUrn,\n\tcollections,\n\tbackTo,\n\tresultTo,\n}: CollectionResultsOverviewProps): JSX.Element {\n\tconst l = useLocalization(locales);\n\n\tconst results = categorizeResults(session.resultsList).collections.get(collectionUrn as Urn<\"collection\">) ?? [];\n\n\tconst title = (\n\t\t<CenterAlignTwo\n\t\t\tgrow=\"left\"\n\t\t\tleft={<CollectionLabel collectionUrn={collectionUrn} collections={collections} />}\n\t\t\tright={<Badge kind=\"Dark\">{l.matches}</Badge>}\n\t\t/>\n\t);\n\n\tconst itemNameMap = new Map(session.itemsList.map(item => [item.urn, item.meta?.name]));\n\n\treturn (\n\t\t<div className=\"CollectionResultsOverview\">\n\t\t\t<OverviewContainer backTo={backTo} title={title}>\n\t\t\t\t{results.map(({ item, document, result }) => {\n\t\t\t\t\tconst itemName = itemNameMap.get(PicapicaUrn.stringify(item)) ?? l.unknownItem;\n\t\t\t\t\tconst documentName = document.documentId;\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div key={result.urn}>\n\t\t\t\t\t\t\t<Link className={Buttons.BUTTON} to={resultTo(result)}>\n\t\t\t\t\t\t\t\t<CenterAlignTwo\n\t\t\t\t\t\t\t\t\tgrow=\"left\"\n\t\t\t\t\t\t\t\t\tleft={\n\t\t\t\t\t\t\t\t\t\t<span className=\"item-vs\">\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"left\">{itemName}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"vs\">vs.</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"right\">{documentName}</span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tright={\n\t\t\t\t\t\t\t\t\t\tsession.status === Session.ComputeStatus.STATUS_COMPLETED ? (\n\t\t\t\t\t\t\t\t\t\t\t<Badge kind=\"Light\">{result.seedsList.length}</Badge>\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<LoaderAnimation />\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t})}\n\n\t\t\t\t{results.length === 0 && <div className=\"no-results\">{l.noResults}</div>}\n\t\t\t</OverviewContainer>\n\t\t</div>\n\t);\n}\n\nconst locales: Locales<SimpleString<\"back\" | \"analysisResults\" | \"results\" | \"matches\" | \"noResults\" | \"unknownItem\">> =\n\t{\n\t\ten: {\n\t\t\tback: \"Back\",\n\n\t\t\tanalysisResults: \"Analysis results\",\n\t\t\tresults: \"Results\",\n\t\t\tmatches: \"Matches\",\n\t\t\tnoResults: \"No results\",\n\n\t\t\tunknownItem: \"<unknown>\",\n\t\t},\n\t\tde: {\n\t\t\tback: \"Zurück\",\n\n\t\t\tanalysisResults: \"Analyse\\xADergebnisse\",\n\t\t\tresults: \"Ergebnisse\",\n\t\t\tmatches: \"Treffer\",\n\t\t\tnoResults: \"Keine Ergebnisse\",\n\n\t\t\tunknownItem: \"<unbekannt>\",\n\t\t},\n\t};\n","/**\n * Shuffles the given array.\n */\nfunction shuffle<T>(array: T[]): void {\n\tlet j, x, i;\n\tfor (i = array.length - 1; i > 0; i--) {\n\t\tj = Math.floor(Math.random() * (i + 1));\n\t\tx = array[i];\n\t\tarray[i] = array[j];\n\t\tarray[j] = x;\n\t}\n}\n\n/**\n * Returns a random subset of the given values with `min(count, values.length)` elements.\n *\n * @param values\n * @param count\n * @returns\n */\nfunction randomValues<T>(values: readonly T[], count: number): T[] {\n\tif (values.length <= count) return values.slice(0);\n\tif (count === 1) return [values[Math.floor(Math.random() * values.length)]];\n\n\tconst copy = values.slice(0);\n\tshuffle(copy);\n\treturn copy.slice(0, count);\n}\n\n/**\n * A least recently used cache.\n */\nexport class LRUCache<V> {\n\tsize: number;\n\n\tprivate _length: number;\n\tprivate _head: CacheNode<string, V>;\n\tprivate _tail: CacheNode<string, V>;\n\tprivate _map: Record<string, CacheNode<string, V>> = {};\n\n\t/**\n\t * Creates an instance of LRUCache.\n\t *\n\t * @param size The maximum size of the cache.\n\t */\n\tconstructor(size = 100) {\n\t\tthis.size = size;\n\t\tthis._length = 0;\n\n\t\tthis._head = new CacheNode<string, V>(null as any, null as any);\n\t\tthis._tail = new CacheNode<string, V>(null as any, null as any);\n\t\tthis._head.next = this._tail;\n\t\tthis._tail.prev = this._head;\n\t}\n\n\t/**\n\t * Adds a new element to the cache.\n\t *\n\t * @param key The key of the element.\n\t * @param obj The element.\n\t */\n\tadd(key: string, obj: V): void {\n\t\treturn this.addAll({ [key]: obj });\n\t}\n\t/**\n\t * Adds any number of key-value-pairs to the cache.\n\t *\n\t * @param map The collection of key-value-pairs.\n\t */\n\taddAll(map: Record<string, V>): void {\n\t\tlet keys = Object.keys(map);\n\t\tif (keys.length === 0) return;\n\t\tif (keys.length > this.size) keys = keys.slice(0, this.size);\n\n\t\tconst toRemove = keys.length + this._length - this.size;\n\t\tif (toRemove > 0) {\n\t\t\trandomValues(Object.keys(this._map), toRemove).forEach(key => {\n\t\t\t\tthis.remove(key);\n\t\t\t});\n\t\t}\n\n\t\tfor (const key of keys) {\n\t\t\tconst node = new CacheNode<string, V>(key, map[key]);\n\t\t\tthis._tail.insertBefore(node);\n\t\t\tthis._map[key] = node;\n\t\t\tthis._length++;\n\t\t}\n\t}\n\n\t/**\n\t * Returns the cached value.\n\t *\n\t * @param key The key of the cached element.\n\t * @param defaultValue The default value.\n\t * @returns The cached element of the default value.\n\t */\n\tget(key: string, defaultValue: V): V;\n\tget(key: string, defaultValue?: V): V | undefined;\n\tget(key: string, defaultValue?: V): V | undefined {\n\t\tconst node = this._map[key];\n\t\tif (node) {\n\t\t\tnode.remove();\n\t\t\tthis._head.insertAfter(node);\n\t\t\treturn node.obj;\n\t\t} else {\n\t\t\treturn defaultValue;\n\t\t}\n\t}\n\n\t/**\n\t * Returns whether an element with the given key is cached.\n\t *\n\t * @param key The key of the cached element.\n\t * @returns\n\t */\n\tcontains(key: string): boolean {\n\t\treturn Boolean(this._map[key]);\n\t}\n\n\t/**\n\t * Removes the cached element with the given key.\n\t *\n\t * @param key The key of the cached element.\n\t * @returns Whether there was an element cached.\n\t */\n\tremove(key: string): boolean {\n\t\tconst node = this._map[key];\n\t\tif (!node) return false;\n\t\tthis._removeNode(node);\n\t\treturn true;\n\t}\n\n\t_removeNode(node: CacheNode<string, V>): void {\n\t\tthis._length--;\n\t\tdelete this._map[node.key];\n\t\tnode.remove();\n\t}\n}\n\n/**\n * A node used by the internal implementation of the LRU cache.\n */\nclass CacheNode<K, V> {\n\tkey: K;\n\tobj: V;\n\n\tprev: CacheNode<K, V> | undefined = undefined;\n\tnext: CacheNode<K, V> | undefined = undefined;\n\n\tconstructor(key: K, obj: V) {\n\t\tthis.key = key;\n\t\tthis.obj = obj;\n\t}\n\n\tremove(): void {\n\t\tthis.prev!.next = this.next;\n\t\tthis.next!.prev = this.prev;\n\t}\n\n\tinsertAfter(afterNode: CacheNode<K, V>): void {\n\t\tafterNode.next = this.next;\n\t\tafterNode.prev = this;\n\n\t\tthis.next!.prev = afterNode;\n\t\tthis.next = afterNode;\n\t}\n\tinsertBefore(beforeNode: CacheNode<K, V>): void {\n\t\treturn this.prev!.insertAfter(beforeNode);\n\t}\n}\n","import { useEffect, useState } from \"react\";\nimport { SimpleCombinedDiff } from \"./alignment\";\nimport { LRUCache } from \"./lru-cache\";\nimport { useAsyncEffect } from \"./react-util\";\nimport { lazy, noop } from \"./util\";\n\nlet pendingResolvesCounter = 0;\nconst pendingResolves = new Map<number, (diff: SimpleCombinedDiff) => void>();\n\nconst getWorker = lazy(() => {\n\tconst worker = new Worker(new URL(\"./alignment.worker.ts\", import.meta.url));\n\tworker.onmessage = ({ data: { diff, id } }) => {\n\t\tconst resolve = pendingResolves.get(id);\n\t\tpendingResolves.delete(id);\n\t\tif (resolve) {\n\t\t\tresolve(diff);\n\t\t}\n\t};\n\treturn worker;\n});\n\nconst promiseCache = new LRUCache<Promise<SimpleCombinedDiff>>(500);\nconst resultCache = new LRUCache<SimpleCombinedDiff>(500);\n\nfunction getCacheKey(left: string, right: string): string {\n\treturn left + \"\\0\" + right;\n}\nfunction getSimpleCombinedDiff(left: string, right: string): Promise<SimpleCombinedDiff> {\n\tconst key = getCacheKey(left, right);\n\tlet promise = promiseCache.get(key);\n\tif (promise === undefined) {\n\t\tpromise = new Promise<SimpleCombinedDiff>(resolve => {\n\t\t\tconst id = pendingResolvesCounter++;\n\t\t\tpendingResolves.set(id, resolve);\n\t\t\tgetWorker().postMessage({ left, right, id });\n\t\t});\n\t\tpromiseCache.add(key, promise);\n\t\tpromise.then(diff => resultCache.add(key, diff));\n\t}\n\treturn promise;\n}\nfunction getCachedSimpleCombinedDiff(left: string, right: string): SimpleCombinedDiff | undefined {\n\tconst key = getCacheKey(left, right);\n\treturn resultCache.get(key);\n}\n\nexport interface AlignmentRequest {\n\tleft: string;\n\tright: string;\n}\nexport interface Alignment {\n\treadonly left: string;\n\treadonly right: string;\n\tdiff: SimpleCombinedDiff | undefined;\n}\n\n/**\n * Returns the alignments for some strings.\n *\n * The purpose of this hooks is to provide a convenient way to use a web worker to compute the alignment.\n *\n * @param key\n * @param requests\n * @returns\n */\nexport function useAlignment(key: string, requests: readonly AlignmentRequest[]): [readonly Alignment[]] {\n\tconst [requestsKey, setRequestsKey] = useState(key);\n\tconst [state, setState] = useState<readonly Alignment[]>(() => GetInitialAlignments(requests));\n\n\tuseEffect(() => {\n\t\tif (key !== requestsKey) {\n\t\t\tsetRequestsKey(key);\n\t\t\tsetState(GetInitialAlignments(requests));\n\t\t}\n\t}, [key, requestsKey, requests]);\n\n\tuseAsyncEffect<readonly Alignment[] | undefined>(\n\t\tasync token => {\n\t\t\t// all alignments are computed\n\t\t\tif (state.every(a => a.diff !== undefined)) return;\n\n\t\t\tconst newState = [...state];\n\n\t\t\t// try to fill-in as many cached results as possible\n\t\t\tfor (let i = 0; i < state.length; i++) {\n\t\t\t\tconst alignment = state[i];\n\t\t\t\tif (alignment.diff === undefined) {\n\t\t\t\t\tconst diff = getCachedSimpleCombinedDiff(alignment.left, alignment.right);\n\t\t\t\t\tif (diff !== undefined) {\n\t\t\t\t\t\tnewState[i] = { ...alignment, diff };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// compute at most one diff\n\t\t\tfor (let i = 0; i < state.length; i++) {\n\t\t\t\tconst alignment = state[i];\n\t\t\t\tif (alignment.diff === undefined) {\n\t\t\t\t\tnewState[i] = { ...alignment, diff: await getSimpleCombinedDiff(alignment.left, alignment.right) };\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn newState;\n\t\t},\n\t\tnewState => {\n\t\t\tif (newState) {\n\t\t\t\tsetState(newState);\n\t\t\t}\n\t\t},\n\t\tnoop,\n\t\t[state]\n\t);\n\n\treturn [state];\n}\n\nfunction GetInitialAlignments(requests: readonly AlignmentRequest[]): readonly Alignment[] {\n\treturn requests.map(r => {\n\t\treturn { left: r.left, right: r.right, diff: getCachedSimpleCombinedDiff(r.left, r.right) };\n\t});\n}\n","import { useQuery } from \"react-query\";\nimport { GetTextRequest, GetTextResponse } from \"./generated/v1/services_pb\";\nimport { Result, Span } from \"./generated/v1/types_pb\";\nimport { getSessionClient } from \"./session/client\";\nimport { PicapicaUrn } from \"./session/urn\";\nimport { DeepReadonly } from \"./util\";\n\nexport interface SeedText {\n\treadonly a: ResultText;\n\treadonly b: ResultText;\n}\nexport interface ResultText {\n\treadonly resourceUrn: string;\n\treadonly span: DeepReadonly<Span.AsObject>;\n\treadonly text: string;\n}\n\nexport function useResultText(result: DeepReadonly<Result.AsObject>): [readonly SeedText[] | undefined] {\n\tconst query = useQuery([\"result-text\", result.urn] as const, {\n\t\t// text is an immutable resource, so we don't need to refetch\n\t\trefetchInterval: false,\n\t\trefetchOnMount: false,\n\t\trefetchOnReconnect: false,\n\t\trefetchOnWindowFocus: false,\n\n\t\tqueryFn: async () => {\n\t\t\tconst data = getSpanData(result);\n\t\t\tconst client = getSessionClient();\n\n\t\t\tconst resultUrn = PicapicaUrn.parse(result.urn);\n\t\t\tif (resultUrn.type !== \"result\") throw new Error(\"Invalid result urn.\");\n\t\t\tconst sessionUrn = PicapicaUrn.stringify({ type: \"session\", sessionId: resultUrn.sessionId });\n\n\t\t\tconst texts = await Promise.all(\n\t\t\t\tdata.map(({ resourceUrn, span }) => {\n\t\t\t\t\tconst s = new Span();\n\t\t\t\t\ts.setBegin(span.begin);\n\t\t\t\t\ts.setEnd(span.end);\n\t\t\t\t\ts.setIndex(span.index);\n\n\t\t\t\t\tconst req = new GetTextRequest();\n\t\t\t\t\treq.setSessionUrn(sessionUrn);\n\t\t\t\t\treq.setResourceUrn(resourceUrn);\n\t\t\t\t\treq.setSpan(s);\n\n\t\t\t\t\treturn client.getText(req, null);\n\t\t\t\t})\n\t\t\t);\n\n\t\t\treturn getSeedTexts(data, texts);\n\t\t},\n\t});\n\n\treturn [query.data];\n}\n\ninterface SpanData {\n\tresourceUrn: string;\n\tspan: DeepReadonly<Span.AsObject>;\n}\nfunction getSpanData(result: DeepReadonly<Result.AsObject>): SpanData[] {\n\tconst data: SpanData[] = [];\n\n\tif (!result.resources) throw new Error(\"Invalid result object: Undefined resources\");\n\tconst { urnA, urnB } = result.resources;\n\n\tfor (const { span1, span2 } of result.seedsList) {\n\t\tif (!span1 || !span2) throw new Error(\"Invalid result object: Undefined span in seed list\");\n\t\tdata.push({ resourceUrn: urnA, span: span1 });\n\t\tdata.push({ resourceUrn: urnB, span: span2 });\n\t}\n\n\treturn data;\n}\n\nfunction getSeedTexts(data: readonly SpanData[], texts: readonly GetTextResponse[]): SeedText[] {\n\tconst result: SeedText[] = [];\n\n\tfor (let i = 0; i < data.length; i += 2) {\n\t\tresult.push({\n\t\t\ta: { ...data[i + 0], text: texts[i + 0].getTextSpan()?.getText() ?? \"\" },\n\t\t\tb: { ...data[i + 1], text: texts[i + 1].getTextSpan()?.getText() ?? \"\" },\n\t\t});\n\t}\n\n\treturn result;\n}\n","import React from \"react\";\nimport { Helmet } from \"react-helmet\";\nimport { AlignmentView } from \"../elements/alignment-view\";\nimport { CenterAlignTwo } from \"../elements/center-align-two\";\nimport { ItemTypeIcon } from \"../elements/icon\";\nimport { Page } from \"../elements/page\";\nimport { OverviewContainer } from \"../elements/results-overview\";\nimport { SessionState } from \"../elements/session-creating-loading\";\nimport { SharedHead } from \"../elements/shared-header\";\nimport { Session } from \"../lib/generated/v1/services_pb\";\nimport * as types from \"../lib/generated/v1/types_pb\";\nimport { Locales, SimpleString } from \"../lib/localization\";\nimport { toResults } from \"../lib/page-links\";\nimport { dynamic } from \"../lib/react-util\";\nimport { PicapicaUrn } from \"../lib/session/urn\";\nimport { getLocationSearchParams } from \"../lib/url-params\";\nimport { useAlignment } from \"../lib/use-alignment\";\nimport { useCollectionDocument } from \"../lib/use-collection-document\";\nimport { useLocalization } from \"../lib/use-localization\";\nimport { SeedText, useResultText } from \"../lib/use-result-text\";\nimport { Ready, useLoadSession } from \"../lib/use-session\";\nimport { debugAssert, DeepReadonly } from \"../lib/util\";\nimport \"./result.scss\";\n\nexport default function ResultPage(): JSX.Element {\n\treturn (\n\t\t<>\n\t\t\t{dynamic(() => (\n\t\t\t\t<Result />\n\t\t\t))}\n\t\t\t<SharedHead />\n\t\t\t<Helmet>\n\t\t\t\t<title>Picapica</title>\n\t\t\t</Helmet>\n\t\t</>\n\t);\n}\n\nfunction Result(): JSX.Element {\n\tconst [state] = useLoadSession();\n\n\tconst onReady = ({ session }: Ready): JSX.Element => {\n\t\treturn (\n\t\t\t<OverviewContainer\n\t\t\t\ttitle=\"Text alignment\"\n\t\t\t\tbackTo={toResults({\n\t\t\t\t\turn: session.urn,\n\t\t\t\t\tview: getLocationSearchParams().get(\"view\") ?? undefined,\n\t\t\t\t})}>\n\t\t\t\t<ResultValidity session={session} />\n\t\t\t</OverviewContainer>\n\t\t);\n\t};\n\n\treturn (\n\t\t<Page className=\"Result\" header=\"small\">\n\t\t\t<SessionState state={state} onReady={onReady} />\n\t\t</Page>\n\t);\n}\n\nfunction ResultValidity({ session }: { session: DeepReadonly<Session.AsObject> }): JSX.Element {\n\tconst l = useLocalization(locales);\n\n\tconst pageUrn = getLocationSearchParams().get(\"urn\");\n\tconst result = session.resultsList.find(r => r.urn === pageUrn);\n\n\tif (!result) {\n\t\treturn (\n\t\t\t<div className=\"invalid-result-error\">\n\t\t\t\t<p>{l.invalidUrn}</p>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tif (result.status !== types.Result.ResultStatusCode.STATUS_OK) {\n\t\treturn <div className=\"invalid-result-error\">{l.failedResult(result.status)}</div>;\n\t}\n\n\tdebugAssert(result.resources !== undefined, \"Expected that the result object has resources\");\n\tconst left = getResultResource(result.resources.urnA, session);\n\tconst right = getResultResource(result.resources.urnB, session);\n\n\tconst error = left.type === \"error\" ? left : right.type === \"error\" ? right : undefined;\n\tif (error) {\n\t\tthrow new Error(\"\");\n\t}\n\n\tif (left.type === \"error\") {\n\t\treturn (\n\t\t\t<div className=\"invalid-result-error\">\n\t\t\t\t<p>{l[`resultError${left.error}`]}</p>\n\t\t\t</div>\n\t\t);\n\t}\n\tif (right.type === \"error\") {\n\t\treturn (\n\t\t\t<div className=\"invalid-result-error\">\n\t\t\t\t<p>{l[`resultError${right.error}`]}</p>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn <ResultView left={left} right={right} result={result} />;\n}\n\ntype ResultResource = ResultResourceSessionItem | ResultResourceCollectionDocument;\ninterface ResultResourceSessionItem {\n\ttype: \"item\";\n\titem: DeepReadonly<types.Item.AsObject>;\n}\ninterface ResultResourceCollectionDocument {\n\ttype: \"document\";\n\tsessionUrn: string;\n\tcollectionUrn: string;\n\tdocumentUrn: string;\n}\ninterface ResultResourceError {\n\ttype: \"error\";\n\terror: \"InvalidUrnType\" | \"UnknownItem\";\n}\nfunction getResultResource(urn: string, session: DeepReadonly<Session.AsObject>): ResultResource | ResultResourceError {\n\tconst parsed = PicapicaUrn.parse(urn);\n\n\tif (parsed.type === \"item\") {\n\t\tconst item = session.itemsList.find(i => i.urn === urn);\n\t\tif (!item) return { type: \"error\", error: \"UnknownItem\" };\n\t\treturn { type: \"item\", item };\n\t}\n\n\tif (parsed.type === \"document\") {\n\t\tconst collectionUrn = PicapicaUrn.stringify({ type: \"collection\", collectionId: parsed.collectionId });\n\t\treturn { type: \"document\", documentUrn: urn, sessionUrn: session.urn, collectionUrn };\n\t}\n\n\treturn { type: \"error\", error: \"InvalidUrnType\" };\n}\n\ninterface ResultViewProps {\n\treadonly result: DeepReadonly<types.Result.AsObject>;\n\treadonly left: ResultResource;\n\treadonly right: ResultResource;\n}\n\nfunction ResultView({ result, left, right }: ResultViewProps): JSX.Element {\n\tconst [texts] = useResultText(result);\n\n\treturn (\n\t\t<>\n\t\t\t<ResultSummary result={result} />\n\t\t\t{texts?.map((text, i) => {\n\t\t\t\treturn (\n\t\t\t\t\t<ResultSeedView key={i} alignmentKey={`${i}:${result.urn}`} left={left} right={right} text={text} />\n\t\t\t\t);\n\t\t\t})}\n\t\t</>\n\t);\n}\n\ninterface ResultSummaryProps {\n\treadonly result: DeepReadonly<types.Result.AsObject>;\n}\nfunction ResultSummary({ result }: ResultSummaryProps): JSX.Element {\n\tconst l = useLocalization(locales);\n\n\tconst [texts] = useResultText(result);\n\n\tconst [alignments] = useAlignment(\n\t\t`${texts?.length}:${result.urn}`,\n\t\ttexts?.map(t => ({ left: t.a.text, right: t.b.text })) ?? []\n\t);\n\n\tlet sharedWords = 0;\n\tlet incomplete = texts === undefined;\n\tif (texts) {\n\t\tfor (const alignment of alignments) {\n\t\t\tsharedWords += alignment.diff?.sharedWords ?? 0;\n\t\t\tincomplete ||= alignment.diff === undefined;\n\t\t}\n\t}\n\n\treturn (\n\t\t<div className=\"ResultSummary\">\n\t\t\t<p className=\"summary\">{l.reusedPassages(result.seedsList.length)}</p>\n\t\t\t<p className=\"details\">{l.detailed(result.seedsList.length, sharedWords, incomplete)}</p>\n\t\t</div>\n\t);\n}\n\ninterface ResultSeedViewProps {\n\treadonly left: ResultResource;\n\treadonly right: ResultResource;\n\treadonly text: SeedText;\n\treadonly alignmentKey: string;\n}\nfunction ResultSeedView({ left, right, text, alignmentKey }: ResultSeedViewProps): JSX.Element {\n\treturn (\n\t\t<div className=\"ResultSeedView\">\n\t\t\t<div className=\"header\">\n\t\t\t\t<div className=\"left\">\n\t\t\t\t\t<ResultLabel resource={left} />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"right\">\n\t\t\t\t\t<ResultLabel resource={right} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"alignment\">\n\t\t\t\t<AlignmentView alignmentKey={alignmentKey} left={text.a.text} right={text.b.text} />\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\ninterface ResultLabelProps {\n\tresource: ResultResource;\n}\nfunction ResultLabel({ resource }: ResultLabelProps): JSX.Element {\n\treturn (\n\t\t<span className=\"ResultLabel\">\n\t\t\t{resource.type === \"item\" ? (\n\t\t\t\t<ItemResultLabel resource={resource} />\n\t\t\t) : (\n\t\t\t\t<DocumentResultLabel resource={resource} />\n\t\t\t)}\n\t\t</span>\n\t);\n}\nfunction ItemResultLabel({ resource }: { resource: ResultResourceSessionItem }): JSX.Element {\n\tconst { item } = resource;\n\n\treturn (\n\t\t<CenterAlignTwo\n\t\t\tgrow=\"right\"\n\t\t\tleft={<ItemTypeIcon type={item.resource?.type ?? types.Item.Resource.Type.TYPE_UNSPECIFIED} />}\n\t\t\tright={<span className=\"text\">{item.meta?.name ?? \"\"}</span>}\n\t\t/>\n\t);\n}\nfunction DocumentResultLabel({ resource }: { resource: ResultResourceCollectionDocument }): JSX.Element {\n\tconst { documentUrn, sessionUrn } = resource;\n\n\tconst document = useCollectionDocument(sessionUrn, documentUrn);\n\n\treturn (\n\t\t<span className=\"ResultLabel\">\n\t\t\t<span className=\"text\">{document?.properties?.title ?? \"\"}</span>\n\t\t</span>\n\t);\n}\n\nconst locales: Locales<\n\tSimpleString<\"invalidUrn\" | `resultError${ResultResourceError[\"error\"]}`> & {\n\t\tfailedResult: (status: types.Result.ResultStatusCode) => JSX.Element;\n\t\treusedPassages: (reused: number) => JSX.Element;\n\t\tdetailed: (reused: number, sharedWords: number, incomplete: boolean) => JSX.Element;\n\t}\n> = {\n\ten: {\n\t\tinvalidUrn: \"Invalid link. The result you are trying to access is not available.\",\n\t\tfailedResult(status) {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t<p>Picapica was unable to calculate this result due to a server error.</p>\n\t\t\t\t\t<p>Status code: {status}</p>\n\t\t\t\t</>\n\t\t\t);\n\t\t},\n\n\t\tresultErrorInvalidUrnType:\n\t\t\t\"Invalid URN type in result. This is a problem with Picapica itself. Please report this bug.\",\n\t\tresultErrorUnknownItem:\n\t\t\t\"Invalid item in result. The item has likely been deleted which means that this result can no longer be viewed.\",\n\n\t\treusedPassages(reused) {\n\t\t\tif (reused === 1) {\n\t\t\t\treturn <>Found 1 reused passage.</>;\n\t\t\t}\n\t\t\treturn <>Found {reused} reused passages.</>;\n\t\t},\n\t\tdetailed(reused, sharedWords, incomplete) {\n\t\t\tconst details: string[] = [];\n\n\t\t\tdetails.push(reused === 1 ? `1 reused passage` : `${reused} reused passages`);\n\n\t\t\tconst atLeast = incomplete ? \">\" : \"\";\n\t\t\tdetails.push(sharedWords === 1 ? `${atLeast}1 shared word` : `${atLeast}${sharedWords} shared words`);\n\n\t\t\treturn <>Detailed comparison of your submitted document: {details.join(\", \")}</>;\n\t\t},\n\t},\n\tde: {\n\t\tinvalidUrn: \"Falscher Link. Das Ergebnis ist nicht verfügbar.\",\n\t\tfailedResult(status) {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t<p>Picapica konnte dieses Ergebnis nicht berechnen wegen eines Serverproblems.</p>\n\t\t\t\t\t<p>Statuscode: {status}</p>\n\t\t\t\t</>\n\t\t\t);\n\t\t},\n\n\t\tresultErrorInvalidUrnType:\n\t\t\t\"Flascher URN-Type im Ergebnis. Dies ist ein Problem in der Picapica Software. Bitte melden Sie diesen Fehler.\",\n\t\tresultErrorUnknownItem:\n\t\t\t\"Invalid item in result. The item has likely been deleted which means that this result can no longer be viewed.\",\n\n\t\treusedPassages(reused) {\n\t\t\tif (reused === 1) {\n\t\t\t\treturn <>1 wiederverwendete Passage gefunden.</>;\n\t\t\t}\n\t\t\treturn <>{reused} wiederverwendete Passagen gefunden.</>;\n\t\t},\n\t\tdetailed(reused, sharedWords, incomplete) {\n\t\t\tconst details: string[] = [];\n\n\t\t\tdetails.push(reused === 1 ? `1 wiederverwendete Passage` : `${reused} wiederverwendete Passagen`);\n\n\t\t\tconst atLeast = incomplete ? \">\" : \"\";\n\t\t\tdetails.push(\n\t\t\t\tsharedWords === 1 ? `${atLeast}1 gemeinsames Wort` : `${atLeast}${sharedWords} gemeinsame Wörter`\n\t\t\t);\n\n\t\t\treturn <>Detailierter Vergleich Ihres eingereichten Dokuments: {details.join(\", \")}</>;\n\t\t},\n\t},\n};\n","import { useQuery } from \"react-query\";\nimport { GetDocumentRequest } from \"./generated/v1/services_pb\";\nimport { Document } from \"./generated/v1/types_pb\";\nimport { getSessionClient } from \"./session/client\";\nimport { DeepReadonly } from \"./util\";\n\nexport function useCollectionDocument(\n\tsessionUrn: string,\n\tdocumentUrn: string\n): DeepReadonly<Document.AsObject> | undefined {\n\tconst query = useQuery([\"collection-document\", sessionUrn, documentUrn] as const, {\n\t\t// collections are an immutable resource, so we don't need to refetch\n\t\trefetchInterval: false,\n\t\trefetchOnMount: false,\n\t\trefetchOnReconnect: false,\n\t\trefetchOnWindowFocus: false,\n\n\t\tqueryFn: async () => {\n\t\t\tconst req = new GetDocumentRequest();\n\t\t\treq.setSessionUrn(sessionUrn);\n\t\t\treq.setDocumentUrn(documentUrn);\n\n\t\t\tconst resp = await getSessionClient().getDocument(req, null);\n\t\t\treturn resp.toObject().document;\n\t\t},\n\t});\n\n\treturn query.data;\n}\n"],"names":["AlignmentView","memo","props","alignments","useAlignment","alignmentKey","diff","className","map","left","i","DiffView","key","index","total","length","right","style","gridRow","equal","changed","type","removed","added","changedClass","trim","test","Change","text","isFirst","context","tokens","tokenizeWords","rest","splitRest","FadeText","join","position","Omitted","words","reverse","start","end","split","stringLength","splice","fadeLength","chars","fade","c","opacity","l","useLocalization","locales","omitted","en","de","CenterAlignTwo","grow","knownCollections","core_fulltext_languagenameenglish","title","EMPTY_OBJ","Label","icon","kind","SubmittedFilesLabel","submittedFiles","CollectionLabel","urn","collection","PicapicaUrn","urnString","collectionUrn","parsed","undefined","collections","find","processProps","known","collectionId","useCollectionLocalization","properties","name","description","UnknownCollectionLabel","unknown","LoaderAnimation","id","categorizeResults","results","categories","items","Map","invalid","addDocument","item","document","result","list","get","set","push","a","resources","urnA","b","urnB","Badge","children","OverviewContainer","backTo","Buttons","to","back","ResultsOverview","session","itemTo","collectionTo","resultsList","console","error","analysisResults","running","status","Session","ItemResultsOverview","resultTo","matches","itemNameMap","itemsList","meta","leftName","unknownItem","rightName","seedsList","noResults","CollectionResultsOverview","itemName","documentName","documentId","randomValues","values","count","slice","Math","floor","random","copy","array","j","x","shuffle","LRUCache","_map","constructor","size","this","_length","_head","CacheNode","_tail","next","prev","add","obj","addAll","keys","Object","toRemove","forEach","remove","node","insertBefore","defaultValue","insertAfter","contains","Boolean","_removeNode","afterNode","beforeNode","pendingResolvesCounter","pendingResolves","getWorker","lazy","worker","Worker","URL","onmessage","data","resolve","delete","promiseCache","resultCache","getCacheKey","getSimpleCombinedDiff","promise","Promise","postMessage","then","getCachedSimpleCombinedDiff","requests","requestsKey","setRequestsKey","useState","state","setState","GetInitialAlignments","useEffect","useAsyncEffect","async","every","newState","alignment","noop","r","useResultText","query","useQuery","refetchInterval","refetchOnMount","refetchOnReconnect","refetchOnWindowFocus","queryFn","Error","span1","span2","resourceUrn","span","getSpanData","client","getSessionClient","resultUrn","sessionUrn","sessionId","texts","all","s","Span","setBegin","begin","setEnd","setIndex","req","GetTextRequest","setSessionUrn","setResourceUrn","setSpan","getText","getTextSpan","getSeedTexts","ResultPage","dynamic","Result","Helmet","useLoadSession","header","onReady","toResults","view","getLocationSearchParams","ResultValidity","pageUrn","invalidUrn","types","failedResult","debugAssert","getResultResource","ResultView","documentUrn","ResultSummary","ResultSeedView","t","sharedWords","incomplete","reusedPassages","detailed","ResultLabel","resource","ItemResultLabel","DocumentResultLabel","GetDocumentRequest","setDocumentUrn","getDocument","toObject","useCollectionDocument","resultErrorInvalidUrnType","resultErrorUnknownItem","reused","details","atLeast"],"sourceRoot":""}